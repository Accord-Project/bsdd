<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Vladimir Alexiev, Mihail Radkov, Nataliya Keberle" />
  <meta name="keywords" content="Linked building data, LBD, buildingSMART Data Dictionary, bSDD, FAIR data, data quality" />
  <title>Semantic bSDD</title>
  <style>
    html {
      font-family: Georgia,serif;
      font-size: 12pt;
      line-height: 1;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 100%;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 12px;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      html {
        background-color: white;
      }
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, Consolas, 'Lucida Console', monospace;
      font-size: 85%;
      margin: 0;
      hyphens: manual;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="icon" type="image/x-icon" href="img/favicon.ico">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Semantic bSDD</h1>
<p class="subtitle">Improving the GraphQL, JSON and RDF Representations of buildingSmart Data Dictionary</p>
<p class="author">Vladimir Alexiev, Mihail Radkov, Nataliya Keberle</p>
<p class="date">&lt;2023-03-14&gt;</p>
</header>
<p><link rel="icon" type="image/x-icon" href="img/favicon.ico"></p>
<h1 data-number="1" id="abstract"><span class="header-section-number">1</span> Abstract</h1>
<p>The buildingSmart Data Dictionary (bSDD) is an important shared resource in the Architecture, Engineering, Construction, and Operations (AECO) domain.
It is a collection of datasets ("domains") that define various classifications (objects representing building components, products, and materials),
their properties, allowed values, etc.
bSDD defines a GraphQL API, as well as REST APIs that return JSON and RDF representations.
This improves the interoperability of bSDD and its easier deployment in architectural Computer Aided Design (CAD) and other AECO software.</p>
<p>However, bSDD data is not structured as well as possible, and data retrieved via different APIs is not identical in content and structure.
This lowers bSDD data quality, usability and trust.</p>
<p>We conduct a thorough comparison and analysis of bSDD data related to fulfillment of FAIR (findable, accessible, interoperable, and reusable) principles.
Based on this analysis, we suggest enhancements to make bSDD data better structured and more FAIR.</p>
<p>We implement many of the suggestions by refactoring the original data to make it better structured/interconnected, and more "semantic".
We provide a SPARQL endpoint using <a href="https://graphdb.ontotext.com/">Ontotext GraphDB</a>, and GraphQL endpoint using <a href="https://platform.ontotext.com/semantic-objects/">Ontotext Platform Semantic Objects</a>.
Our detailed work is available at <a href="https://github.com/Accord-Project/bsdd" class="uri">https://github.com/Accord-Project/bsdd</a> (open source) and <a href="https://bsdd.ontotext.com" class="uri">https://bsdd.ontotext.com</a> (home page, schemas, data, sample queries).</p>
<h1 data-number="2" id="introduction"><span class="header-section-number">2</span> Introduction</h1>
<h2 data-number="2.1" id="bsdd"><span class="header-section-number">2.1</span> bSDD</h2>
<p>Reusable data dictionaries are widely used for the electronic exchange of product and component information across industries, improving interoperation between systems.
Examples include:</p>
<ul>
<li><a href="https://cdd.iec.ch/">IEC Common Data Dictionary</a> (IEC CDD): electrical components, units of measure, documents and certificates, etc.</li>
<li><a href="https://eclass.eu/en/">eCl@ss</a>: a product classification and parts description for a variety of industries.</li>
<li>ISO 15926 part 4 <a href="https://rds.posccaesar.org/">Reference Data and Services</a>: for digital information across process plant industries (oil &amp; gas).</li>
<li><a href="https://bsdd.buildingsmart.org/">buildingSMART Data Dictionary (bSDD)</a>: for materials and components in the AECO industry.</li>
</ul>
<p>The bSDD is a hierarchical dictionary of object concepts (Classifications), their Properties and allowed values used in Building Information Models (BIM).
Property sets are predefined by regulation agencies and vendors and extend common property sets of the Industry Foundation Classes (IFC).
This allows to describe specific domains (e.g. transportation) and building elements (e.g. doors, windows, stairs).
bSDD is organized according to the ISO 23386 (2020) Methodology to describe, author and maintain properties in interconnected data dictionaries.
This is a language-independent model used for the development of dictionaries according to ISO 12006-3 (2022) Framework for object-oriented information.</p>
<p>bSDD was initiated to improve interoperability in the building and construction industry.
bSDD is a comprehensive solution that provisions open product data definitions, identification, and distribution methods.</p>
<p>As of February 2023, bSDD keeps descriptions of nearly 80,000 Classifications in 108 domains,
ranging from roads and rails to DIN, Omniclass, Uniclass, IFC extensions, etc.
It is a widely accepted source of BIM reference data.
bSDD uses URLs for nearly all defined entities to enable globalized data use in a variety of AECO applications and structured documents.</p>
<h2 data-number="2.2" id="graphql-benefits"><span class="header-section-number">2.2</span> GraphQL Benefits</h2>
<p><a href="https://graphql.org/">GraphQL</a> as an approach to create simplified "facades" over various storages,
and to provide schema, uniform query language, API and runtime
for handling queries, mutations and subscriptions.
It has many benefits over traditional REST APIs:</p>
<ul>
<li>Avoid over-fetching by specifying exactly which data and in what nested structure should be returned by the server</li>
<li>Data is returned in JSON that is precisely congruent to the shape of the query</li>
<li>Retrieve many resources in a single request; even across storages by using GraphQL Federation</li>
<li>Schema introspection that allows IDEs and query helpers to offer contextual auto-completion at any point in the query</li>
<li>Data validation (for both input through mutations and output through queries) that guarantees type and cardinality conformance (optional/mandatory, single/multi-valued)</li>
</ul>
<p>bSDD does offer GraphQL access:</p>
<ul>
<li>Test: <a href="https://test.bsdd.buildingsmart.org/graphiql/" class="uri">https://test.bsdd.buildingsmart.org/graphiql/</a></li>
<li>Production: <a href="https://api.bsdd.buildingsmart.org/graphqls/" class="uri">https://api.bsdd.buildingsmart.org/graphqls/</a> (secured endpoint).</li>
<li>NOTE: we worked with bSI to get access to the production endpoint, but due to delays all our analysis is done on data from the test endpoint.
Nevertheless, we believe that most of our findings also apply to the production data.</li>
</ul>
<p>Both endpoints use <code>GraphiQL</code> - a graphical interactive in-browser <a href="https://github.com/graphql/graphiql/tree/main/packages/graphiql">GraphQL IDE</a>.</p>
<h2 data-number="2.3" id="original-graphql-bsdd-schema-voyager"><span class="header-section-number">2.3</span> Original GraphQL bSDD Schema: Voyager</h2>
<p><a href="https://ivangoncharov.github.io/graphql-voyager/">GraphQL Voyager</a> (see <a href="https://github.com/IvanGoncharov/graphql-voyager">source</a>) is a visual app
that uses a Schema Introspection query (<code>schemaIntrospection.graphql</code>) to explore a GraphQL endpoint
and displays the schema of the endpoint, allowing the user to search and browse the available types and queries.</p>
<p>We wrote a page <a href="https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-orig.html">bsdd-graphql-voyager-orig</a> (see <code>bsdd-graphql-voyager-orig.html</code>) that deploys Voyager over the bSDD GraphQL endpoint.
We used it to investigate the original bSDD schema:</p>
<figure id="fig:bsdd-graphql-voyager-orig-overview">
<img src="./img/bsdd-graphql-voyager-overview.png" />
<figcaption>
Original bSDD GraphQL Schema: Overview (uncheck “Show leaf fields”)
</figcaption>
</figure>
<p>As we can see, bSDD has 12 entities (object types):</p>
<ul>
<li>Reference entities:
<ul>
<li><code>Country</code></li>
<li><code>Language</code></li>
<li><code>ReferenceDocument</code>, such as a standard</li>
<li><code>Unit</code>: unit of measure</li>
</ul></li>
<li><code>Domain</code>: dataset by a single data provider</li>
<li><code>Property</code>: global property definition
<ul>
<li><code>PropertyRelation</code>: relation between properties</li>
<li><code>PropertyValue</code>: allowed property value for enumerated properties</li>
</ul></li>
<li><code>Classification</code>: object, material, component
<ul>
<li><code>ClassificationRelation</code>: relation between classifications</li>
</ul></li>
<li><code>ClassificationProperty</code>: property that is localized to a classification
<ul>
<li><code>ClassificationPropertyValue</code>: allowed property value for enumerated properties</li>
</ul></li>
</ul>
<p>We can also look at details of the schema:</p>
<figure id="fig:bsdd-graphql-voyager-orig-detail">
<img src="./img/bsdd-graphql-voyager-Classification-ClassificationProperty.png" />
<figcaption>
Original bSDD GraphQL Schema: Detail of Classification and ClassificationProperty
</figcaption>
</figure>
<p>Last but not least, Voyager presents detailed and searchable documentation about the schema;
the same is available in the GraphiQL query tool.</p>
<h2 data-number="2.4" id="original-graphql-bsdd-schema-problems"><span class="header-section-number">2.4</span> Original GraphQL bSDD Schema: Problems</h2>
<p>Even in the Schema Overview (at low level of detail) we can notice some defects:</p>
<ul>
<li>The reference entities (<code>Country, Language, ReferenceDocument, Unit</code>)
are disconnected from the rest of the schema, i.e. not used by the other entities</li>
<li>Relation entities have only an incoming link but no outgoing link.
This means that if you want to get some data of a <code>Classification</code>
and all its related <code>Classifications</code>, you need to issue two queries
because you cannot navigate past <code>ClassificationRelation</code>.</li>
<li>Many entities cannot be queried directly from the root, but have to be reached through their respective "parent" entity.</li>
<li>There are no backward relations (arrows) to get from a lower-level entity back to its "parent" entity.</li>
<li>There are a number of parallel relations (arrows).
This is not needed in GraphQL because the schema can use parameters to distinguish between the different uses.</li>
</ul>
<p>At the high level of detail we can notice more defects:</p>
<ul>
<li><code>Property</code> and <code>ClassificationProperty</code> are very similar, but there's no inheritace/relation between them</li>
<li><code>PropertyValue</code> and <code>ClassificationPropertyValue</code> are exactly the same, so can be reduced to one entity</li>
</ul>
<p>We'll have a lot more to say about this in further sections.
But first let's look at a refactored (improved) schema.</p>
<h2 data-number="2.5" id="refactored-graphql-bsdd-schema-voyager"><span class="header-section-number">2.5</span> Refactored GraphQL bSDD Schema: Voyager</h2>
<p>The main purpose of this work is to refactor the bSDD data and schema in order to improve them.
We explain the refactoring process in the last section.</p>
<p>But we show the refactored schema here in order to compare it to the original schema.
We wrote the web page <a href="https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-refact.html">bsdd-graphql-voyager-refact.html</a> (see <code>bsdd-graphql-voyager-refact.html</code>)
that allows you to explore the refactored schema.</p>
<figure id="fig:bsdd-graphql-voyager-refact-overview">
<img src="./img/bsdd-graphql-voyager-refact-overview.png" />
<figcaption>
Refactored bSDD GraphQL Schema: Overview (uncheck “Show leaf fields”)
</figcaption>
</figure>
<p>Improvements:</p>
<ul>
<li>All entities are queryable directly from the root.
Note: There's a common interface <code>Object</code> that provides functionality common to all entities: the dashed arrows show that each entity implements it.
This creates some clutter in the diagram, but doesn't complicate querying and navigation.</li>
<li>There are no parallel arrows (relations) between entities;
each relation is named the same as the target entity, improving predictability and consistency.</li>
<li>Navigation between entities is bidirectional (e.g. <code>Domain.classification</code> but also <code>Classification.domain</code>),
which is a feature expected of a Knowledge Graph.
<ul>
<li>In particular, the <code>Classification</code> hierarchy can be navigated both up and down (<code>parentClassification, childClassification</code>)</li>
</ul></li>
<li>A query can traverse a <code>Relation</code> entity to get data about the related entity:
<ul>
<li><code>Classification.relation -&gt; ClassificationRelation.related -&gt; Classification</code></li>
<li><code>Property.relation -&gt; PropertyRelation.related -&gt; Property</code></li>
</ul></li>
<li>A single entity <code>PropertyValue</code> is used by both <code>Property</code> and <code>ClassificationProperty</code></li>
</ul>
<p>This does not fix all defects noted with the original diagram.
The reference entities are still not used by the main entities.
To fix that would require data cleaning work
(eg to ensure that Unit code strings used in all Properties and ClassificationProperties are in the reference list).</p>
<p>We can also take a look at a detail of the refactored schema. It looks pretty similar,
but all fields are normalized to singular names,
and strings fields like <code>propertyNamespaceUri</code> are converted to object fields like <code>Property</code>.</p>
<figure id="fig:bsdd-graphql-voyager-refact-detail">
<img src="./img/bsdd-graphql-voyager-refact-Classification-ClassificationProperty.png" />
<figcaption>
Refactored bSDD GraphQL Schema: Detail of Classification and ClassificationProperty
</figcaption>
</figure>
<h2 data-number="2.6" id="graphiql-querying-of-original-endpoint"><span class="header-section-number">2.6</span> GraphiQL Querying of Original Endpoint</h2>
<p><a href="https://test.bsdd.buildingsmart.org/graphiql" class="uri">https://test.bsdd.buildingsmart.org/graphiql</a> is the original GraphQL endpoint.</p>
<figure id="fig:graphiql-orig">
<img src="./img/graphiql-orig.png" />
<figcaption>
GraphiQL Querying of Original bSDD Endpoint
</figcaption>
</figure>
<p>It provides a number of useful features:</p>
<ul>
<li>Online searchable documentation of the GraphQL schema</li>
<li>Auto-completion of field names and parameters at any point in the query: queries practically "write themselves"!</li>
<li>Ability to parameterize queries through Query Variables</li>
<li>Code formatting (Prettifying) of the query</li>
<li>Syntax highlighting</li>
<li>History of previous queries</li>
<li>JSON results that conform exactly to the form of hate query</li>
</ul>
<h2 data-number="2.7" id="graphiql-querying-of-refactored-endpoint"><span class="header-section-number">2.7</span> GraphiQL Querying of Refactored Endpoint</h2>
<p><a href="https://bsdd.ontotext.com/graphiql/" class="uri">https://bsdd.ontotext.com/graphiql/</a> is the refactored GraphQL endpoint:</p>
<figure id="fig:graphiql-refact">
<img src="./img/graphiql-refact.png" />
<figcaption>
GraphiQL Querying of Refactored bSDD Endpoint
</figcaption>
</figure>
<p>We have deployed a newer version of GraphiQL that has all benefits described in the previous section, and adds some more:</p>
<ul>
<li>A hierarchical Explorer pane that shows the total schema structure and allows you to select fields by clicking rather than typing.
The History and Documentation panes are still present (see toggles at the left edge)</li>
<li>Useful keyboard shortcuts</li>
<li>Search in the query text (in addition to search in the Documentation)</li>
<li>Improved syntax highlighting</li>
<li>Multiple query tabs so you can easily access several queries at once</li>
<li>The query response reports errors in addition to returning data
(this comes from our GraphQL server implementation, not from the GraphiQL version)</li>
</ul>
<h2 data-number="2.8" id="files"><span class="header-section-number">2.8</span> Files</h2>
<p>Description of all files in <a href="https://github.com/Accord-Project/bsdd" class="uri">https://github.com/Accord-Project/bsdd</a>:</p>
<ul>
<li><code>bsdd-graphql-schema-orig.json</code>, 116k: original GraphQL schema, obtained with <code>schemaIntrospection.graphql</code></li>
<li><code>bsdd-graphql-schema-refact.json</code>, 867k: refactored GraphQL schema, obtained with <code>schemaIntrospection.graphql</code>.
The endpoint is generated with <a href="https://platform.ontotext.com/semantic-objects/">Ontotext Platform Semantic Objects</a>.
The reason it is so much bigger is that it includes a comprehensive <code>where</code> query language</li>
<li><code>bsdd-graphql-soml-template.yaml</code>: template file for the GraphQL-SOML generator</li>
<li><code>bsdd-graphql-soml-orig.yaml</code>: draft <a href="https://platform.ontotext.com/semantic-objects/soml/index.html">SOML</a> generated from the original GraphQL schema</li>
<li><code>bsdd-graphql-soml-refact.yaml</code>: SOML refactored by hand to make structural improvements. We use this with <a href="https://platform.ontotext.com/semantic-objects/">Ontotext Platform Semantic Objects</a> to generate the refactored GraphQL endpoint</li>
<li><code>bsdd-graphql-soml.patch</code>: difference between the two SOML schemas</li>
<li><code>bsdd-graphql-voyager-orig.html</code>: HTML page that displays the original GraphQL schema with Voyager</li>
<li><code>bsdd-graphql-voyager-refact.html</code>:HTML page that displays the refactored GraphQL schema with Voyager</li>
<li><code>bsdd-ontology.ttl</code>: start of a bSDD ontology, very incomplete</li>
<li><code>index.html</code>: home page source</li>
<li><code>README.org</code>: detailed description of the work we did in emacs <code>orgmode</code> (this file)</li>
<li><code>README.md</code>: detailed description of the work we did, exported to <code>markdown</code></li>
<li><code>README.html</code>: HTML rendition of the work we did</li>
<li><code>paper</code>: paper submitted to LDAC 2023
<ul>
<li><code>bsdd.bib</code>: bibtex file for the paper, made from the <a href="https://www.zotero.org/groups/3007408/semantic_bim">Zotero semantic BIM library</a>, we don't use it</li>
<li><code>bsdd.biblatex</code>: biblatex file for the paper, made from the same library, we use this one</li>
<li><code>Makefile</code>: update the bibliography files</li>
<li><code>paper.md</code>: paper as markdown</li>
<li><code>paper.tex</code>: paper as latex, generated with Scholarly Pandoc</li>
<li><code>paper.pdf</code>: paper as PDF</li>
</ul></li>
<li><code>graphql</code>: GraphQL queries to get the 9 kinds of entities from the original GraphQL endpoint
<ul>
<li>Also <code>schemaIntrospection.graphql</code> that gets the GraphQL schema of an endpoint</li>
</ul></li>
<li><code>graphql-refact</code>: some sample queries against the refactored GraphQL endpoint (TODO: add more?)</li>
<li><code>scripts</code>: all necessary scripts to export data in various formats, convert bSDD schema to SOML, convert JSON to RDF, refactor RDF, etc
<ul>
<li><code>bsdd2json.py</code>: connects to the original GraphQL API and exports all objects of the GraphQL schema as JSON (domains, classifications, classification properties, etc).
There is no way to get more than 5000 classifications per domain (a limitation of the <code>classificationSearch</code> field)</li>
<li><code>bsdd_export.py</code>: export one kind of bSDD entity using a specific GraphQL query</li>
<li><code>bsdd_graphql_api.py</code>: helper module for working with the bSDD GraphQL endpoint</li>
<li><code>graphql2soml.py</code>: generates a draft SOML from a GraphQL endpoint</li>
<li><code>list-zip.sparql</code>: list all files in a zip using SPARQL Anything</li>
<li><code>rdfize.sparql</code>: RDFize a bSDD JSON file using SPARQL Anything</li>
<li><code>rdfize-folder.sparql</code>: RDFize a folder of bSDD JSON files using SPARQL Anything</li>
<li><code>rdfize-zip.sparql</code>: RDFize a zip of bSDD JSON files using SPARQL Anything (doesn't work: <a href="https://github.com/SPARQL-Anything/sparql.anything/issues/335" class="uri">https://github.com/SPARQL-Anything/sparql.anything/issues/335</a>)</li>
<li><code>transform.ru</code>: transform (refactor) RDF data. Described in detail below</li>
</ul></li>
<li><code>dump</code>: scripts to get the complete original bSDD data from the original GraphQL endpoint
<ul>
<li><code>docker-compose.yaml, Dockerfile</code>: docker files</li>
<li><code>dump.sh</code>: perform the dump</li>
<li><code>sparql-anything.bat</code>: batch file to invoke SPARQL Anything</li>
</ul></li>
<li><code>samples</code>: sample bSDD entities:
whole sets (e.g. <code>units</code>)
or selected "interesting" entities with most fields filled (e.g. <code>class-IfcWall, prop-Ifc-ACResistance</code>)
<ul>
<li><code>*-orig.json</code>: original files from GraphQL endpoint or JSON API</li>
<li><code>*-orig.ttl</code>: original files from RDF API (not all can be obtained this way, e.g. Domains cannot)</li>
<li><code>*-refact.ttl</code>: refactored RDF files</li>
<li><code>Makefile</code> to export and convert data</li>
</ul></li>
</ul>
<h2 data-number="2.9" id="endpoints-and-pages"><span class="header-section-number">2.9</span> Endpoints and Pages</h2>
<p>Description of all endpoints that this project worked with and produced:</p>
<ul>
<li><a href="https://bsdd.ontotext.com" class="uri">https://bsdd.ontotext.com</a>: home page, includes all of these links</li>
<li><a href="https://bsdd.ontotext.com/README.html" class="uri">https://bsdd.ontotext.com/README.html</a>: detailed description of the work we did (<a href="https://github.com/Accord-Project/bsdd/issues/14">issue #14</a>: make better version from .md instead of .org)</li>
<li><a href="https://bsdd.ontotext.com/paper/paper.pdf" class="uri">https://bsdd.ontotext.com/paper/paper.pdf</a>: submitted to LDAC 2023</li>
<li><a href="https://bsdd.ontotext.com/paper/presentation.pdf" class="uri">https://bsdd.ontotext.com/paper/presentation.pdf</a>: TODO</li>
<li><a href="https://test.bsdd.buildingsmart.org/graphql/" class="uri">https://test.bsdd.buildingsmart.org/graphql/</a>: original GraphQL endpoint (protected)</li>
<li><a href="https://test.bsdd.buildingsmart.org/graphiql/" class="uri">https://test.bsdd.buildingsmart.org/graphiql/</a>: original GraphQL query editor</li>
<li><a href="https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-orig.html" class="uri">https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-orig.html</a>: original GraphQL schema visualization with Voyager</li>
<li><a href="https://bsdd.ontotext.com/platform" class="uri">https://bsdd.ontotext.com/platform</a>: Semantic Objects workbench: administrative interface for the Ontotext Platform implementing GraphQL (protected)</li>
<li><a href="https://bsdd.ontotext.com/graphql/" class="uri">https://bsdd.ontotext.com/graphql/</a>: refactored GraphQL endpoint (protected)</li>
<li><a href="https://bsdd.ontotext.com/graphiql/" class="uri">https://bsdd.ontotext.com/graphiql/</a>: refactored GraphQL query editor</li>
<li><a href="https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-refact.html" class="uri">https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-refact.html</a>: refactored GraphQL schema visualization with Voyager</li>
<li><a href="https://bsdd.ontotext.com/graphdb" class="uri">https://bsdd.ontotext.com/graphdb</a>: GraphDB Workbench: administrative interface for our semantic database (protected)</li>
<li><a href="https://bsdd.ontotext.com/graphdb/repositories/bsdd" class="uri">https://bsdd.ontotext.com/graphdb/repositories/bsdd</a>: GraphDB SPARQL endpoint</li>
<li><a href="https://bsdd.ontotext.com/graphdb/sparql" class="uri">https://bsdd.ontotext.com/graphdb/sparql</a>: GraphDB SPARQL editor</li>
</ul>
<h1 data-number="3" id="original-bsdd-data"><span class="header-section-number">3</span> Original bSDD Data</h1>
<h2 data-number="3.1" id="getting-bsdd-data-dumps"><span class="header-section-number">3.1</span> Getting bSDD Data Dumps</h2>
<p>Although bSDD is available in RDF, we decided to fetch all data in GraphQL JSON due to RDF defects described below.</p>
<p>We use the script <code>bsdd2json.py</code> to connects to the original GraphQL API
and export all objects of the GraphQL schema as JSON (domains, classifications, classification properties, etc).
Running this script takes around 10 hours due to the large number of objects.
After it finishes, the exported data will be located in the <code>data/</code> directory (not included in Github).</p>
<p>To work with the script, use a virtual Python environment:</p>
<ul>
<li>Create a virtual environment: <code>python3.9 -m venv .venv</code></li>
<li>Activate it: <code>source .venv/bin/activate</code></li>
<li>Install the required libraries: <code>pip install -r scripts/requirements.txt</code></li>
</ul>
<p>The overall process of the script is:</p>
<ul>
<li>Export all "root" types with their attributes, but not relations (object properties)
<ul>
<li>Domains in <code>data/domains.json</code> (<code>Domain</code> in GraphQL)</li>
<li>Countries in <code>data/domains.json</code> (<code>Country</code> in GraphQL)</li>
<li>Languages in <code>data/languages.json</code> (<code>Language</code> in GraphQL)</li>
<li>Measurements units in <code>data/units.json</code> (<code>Unit</code> in GraphQL)</li>
<li>Reference documents in <code>data/reference_documents.json</code> (<code>ReferenceDocument</code> in GraphQL)</li>
</ul></li>
<li>For each exported Domain, create a subdirectory and export all Classifications in that domain in separate JSONs (<code>Classification</code> in GraphQL).
This includes nested objects: <code>ClassificationProperty, ClassificationRelation, ClassificationPropertyValue</code></li>
<li>Collect all unique global Properties and export them in <code>properties.json</code> (<code>Property</code> in GraphQL)</li>
</ul>
<p>On the other hand, <code>bsdd_export.py</code> invokes a given query (with or without variable, which is the <code>namespaceUri</code> of the entity sought), and returns a JSON response.
Examples:</p>
<ul>
<li>Get all domains:</li>
</ul>
<div class="sourceCode" id="cb1" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> scripts/bsdd_export.py getDomains <span class="at">-o</span> domains.json</span></code></pre></div>
<ul>
<li>Get a particular domain:</li>
</ul>
<div class="sourceCode" id="cb2" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">python</span> scripts/bsdd_export.py getDomain <span class="at">-v</span> <span class="st">&quot;URI=https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3&quot;</span> <span class="at">-o</span> ifc-4.3.json</span></code></pre></div>
<h2 data-number="3.2" id="statistics"><span class="header-section-number">3.2</span> Statistics</h2>
<p>Here we provide various statistics about bSDD data.
Although the bSDD schema is rich, we find that some features are rarely used.</p>
<ul>
<li>It is possible that the production bSDD endpoint will have higher use of features
(our counts were done on the test endpoint)</li>
<li>The counts were performed on refactored RDF data, but we guarantee that we have not lost data during refactoring</li>
</ul>
<h3 data-number="3.2.1" id="total-entities"><span class="header-section-number">3.2.1</span> Total Entities</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">c</th>
<th style="text-align: left;">Comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classification</td>
<td style="text-align: left;">31720</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">ClassificationProperty</td>
<td style="text-align: left;">111566</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">ClassificationRelation</td>
<td style="text-align: left;">6420</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Country</td>
<td style="text-align: left;">246</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Domain</td>
<td style="text-align: left;">108</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Language</td>
<td style="text-align: left;">39</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Property</td>
<td style="text-align: left;">36069</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">PropertyValue</td>
<td style="text-align: left;">214121</td>
<td style="text-align: left;">We merged <code>PropertyValue</code> and <code>ClassificationPropertyValue</code> because they have the same structure</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ReferenceDocument</td>
<td style="text-align: left;">484</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Unit</td>
<td style="text-align: left;">603</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>We used this query but then removed uninteresting RDF classes:</p>
<pre class="sparql"><code>select ?type (count(*) as ?c) {
  ?x a ?type
} group by ?type order by desc(?c)</code></pre>
<h3 data-number="3.2.2" id="classifications-per-domain"><span class="header-section-number">3.2.2</span> Classifications Per Domain</h3>
<p>The GraphQL API returns 108 Domains.
The distribution of number of Classifications per domain is as follows:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">domains</th>
<th style="text-align: left;">class from</th>
<th style="text-align: left;">class to</th>
<th style="text-align: left;">Note</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">12</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">12 domains have no data at all (no classifications)</td>
</tr>
<tr class="even">
<td style="text-align: left;">28</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">19</td>
<td style="text-align: left;">11</td>
<td style="text-align: left;">99</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">15</td>
<td style="text-align: left;">100</td>
<td style="text-align: left;">499</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">500</td>
<td style="text-align: left;">999</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">9</td>
<td style="text-align: left;">1000</td>
<td style="text-align: left;">4999</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">5000</td>
<td style="text-align: left;">5000</td>
<td style="text-align: left;">Has more than 5000, but returns only 5000 due to lack of pagination in the GraphQL API</td>
</tr>
</tbody>
</table>
<p>Domains with no classifications:</p>
<pre><code>http://identifier.buildingsmart.org/uri/spr/spr-cfhios-0.1
https://identifier.buildingsmart.org/uri/ArcDox/ArcDox-1.0
https://identifier.buildingsmart.org/uri/BBRI/BBRI-0.1
https://identifier.buildingsmart.org/uri/FCSI/keq-0.1
https://identifier.buildingsmart.org/uri/MTR/MTR-1
https://identifier.buildingsmart.org/uri/bimeta/bimeta-0.1
https://identifier.buildingsmart.org/uri/bimlib/bimlib-ru-temp-1
https://identifier.buildingsmart.org/uri/buildingsmart/demo-2-1.1
https://identifier.buildingsmart.org/uri/csi/omniclass-1
https://identifier.buildingsmart.org/uri/ethz/hosszu-0.1
https://identifier.buildingsmart.org/uri/growingcircle/transsmart-0.1
https://identifier.buildingsmart.org/uri/ifcrail/ifcrail-0.1</code></pre>
<p>One domain has more than 5000 classifications, but returns only 5000 due to lack of pagination in the GraphQL API:</p>
<pre><code>https://identifier.buildingsmart.org/uri/nbs/uniclass2015-1</code></pre>
<h3 data-number="3.2.3" id="fields-used"><span class="header-section-number">3.2.3</span> Fields Used</h3>
<p>This shows the total number of defined fields, and fields that are actually used in various entities.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">total</th>
<th style="text-align: left;">used</th>
<th style="text-align: left;">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classification</td>
<td style="text-align: left;">26</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">73.08%</td>
</tr>
<tr class="even">
<td style="text-align: left;">ClassificationProperty</td>
<td style="text-align: left;">51</td>
<td style="text-align: left;">30</td>
<td style="text-align: left;">58.82%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ClassificationRelation</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">75.00%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Country</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">100.00%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Domain</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">10</td>
<td style="text-align: left;">100.00%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Language</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">100.00%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Property</td>
<td style="text-align: left;">47</td>
<td style="text-align: left;">33</td>
<td style="text-align: left;">70.21%</td>
</tr>
<tr class="even">
<td style="text-align: left;">PropertyValue</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">40.00%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ReferenceDocument</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">100.00%</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unit</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">100.00%</td>
</tr>
</tbody>
</table>
<h3 data-number="3.2.4" id="fields-used-in-classification"><span class="header-section-number">3.2.4</span> Fields Used in Classification</h3>
<p>This shows the percentage of use of fields in Classification.
It ignores null values like <code>""</code> and <code>"[]"</code>.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">field</th>
<th style="text-align: left;">c</th>
<th style="text-align: left;">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bsdd:classificationType</td>
<td style="text-align: left;">30357</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:code</td>
<td style="text-align: left;">30357</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:countryOfOrigin</td>
<td style="text-align: left;">8405</td>
<td style="text-align: left;">27.6872%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:countryOfUse</td>
<td style="text-align: left;">9508</td>
<td style="text-align: left;">31.3206%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:creatorLanguageCode</td>
<td style="text-align: left;">8317</td>
<td style="text-align: left;">27.3973%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:definition</td>
<td style="text-align: left;">8906</td>
<td style="text-align: left;">29.3375%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:deprecationExplanation</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.0033%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:documentReference</td>
<td style="text-align: left;">33</td>
<td style="text-align: left;">0.1087%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:name</td>
<td style="text-align: left;">30357</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:referenceCode</td>
<td style="text-align: left;">29226</td>
<td style="text-align: left;">96.2743%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:relatedIfcEntityName</td>
<td style="text-align: left;">5095</td>
<td style="text-align: left;">16.7836%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:relation</td>
<td style="text-align: left;">5388</td>
<td style="text-align: left;">17.7488%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:status</td>
<td style="text-align: left;">30357</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:subdivisionOfUse</td>
<td style="text-align: left;">25</td>
<td style="text-align: left;">0.0824%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:synonym</td>
<td style="text-align: left;">28404</td>
<td style="text-align: left;">93.5666%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:uid</td>
<td style="text-align: left;">4251</td>
<td style="text-align: left;">14.0034%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:visualRepresentationUri</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">0.0296%</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>prefix bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select ?field (count(?field) as ?c)
where {
  ?cla a bsdd:Classification; ?field ?value .
  filter (?field != rdf:type &amp;&amp; ?value != &quot;&quot; &amp;&amp; ?value !=&quot;[]&quot;)
} group by ?field order by ?field</code></pre>
<h3 data-number="3.2.5" id="fields-used-in-classificationproperty"><span class="header-section-number">3.2.5</span> Fields Used in ClassificationProperty</h3>
<p>This shows the percentage of use of fields in ClassificationProperty.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">field</th>
<th style="text-align: left;">c</th>
<th style="text-align: left;">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bsdd:allowedValue</td>
<td style="text-align: left;">21277</td>
<td style="text-align: left;">19.0712%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:code</td>
<td style="text-align: left;">111566</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:countryOfOrigin</td>
<td style="text-align: left;">20768</td>
<td style="text-align: left;">18.6150%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:countryOfUse</td>
<td style="text-align: left;">19859</td>
<td style="text-align: left;">17.8002%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:creatorLanguageCode</td>
<td style="text-align: left;">19906</td>
<td style="text-align: left;">17.8424%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:dataType</td>
<td style="text-align: left;">104960</td>
<td style="text-align: left;">94.0788%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:definition</td>
<td style="text-align: left;">3964</td>
<td style="text-align: left;">3.5531%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:description</td>
<td style="text-align: left;">17067</td>
<td style="text-align: left;">15.2977%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:dimension</td>
<td style="text-align: left;">940</td>
<td style="text-align: left;">0.8426%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:documentReference</td>
<td style="text-align: left;">859</td>
<td style="text-align: left;">0.7699%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:example</td>
<td style="text-align: left;">4426</td>
<td style="text-align: left;">3.9672%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:methodOfMeasurement</td>
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.0045%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:name</td>
<td style="text-align: left;">111566</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:pattern</td>
<td style="text-align: left;">7</td>
<td style="text-align: left;">0.0063%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:physicalQuantity</td>
<td style="text-align: left;">11678</td>
<td style="text-align: left;">10.4673%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:predefinedValue</td>
<td style="text-align: left;">6219</td>
<td style="text-align: left;">5.5743%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:property</td>
<td style="text-align: left;">111566</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:propertySet</td>
<td style="text-align: left;">17907</td>
<td style="text-align: left;">16.0506%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:propertyValueKind</td>
<td style="text-align: left;">111566</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:status</td>
<td style="text-align: left;">111566</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:subdivisionOfUse</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">0.0170%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:symbol</td>
<td style="text-align: left;">79</td>
<td style="text-align: left;">0.0708%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:uid</td>
<td style="text-align: left;">11602</td>
<td style="text-align: left;">10.3992%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:unit</td>
<td style="text-align: left;">25231</td>
<td style="text-align: left;">22.6153%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:visualRepresentationUri</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;">0.0036%</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select  ?field (count(?field) as ?c)
where {
  ?prop a bsdd:ClassificationProperty; ?field ?value .
  filter (?field != rdf:type &amp;&amp; ?value != &quot;&quot; &amp;&amp; ?value !=&quot;[]&quot;)
} group by ?field order by ?field</code></pre>
<p>Note: <code>allowedValue</code> is a multivalued property, so it is counted separately like this:</p>
<pre class="sparql"><code>select (count(*) as ?c) {
  ?prop a bsdd:ClassificationProperty
  filter exists {?prop bsdd:allowedValue []}
} group by ?field order by ?field</code></pre>
<h3 data-number="3.2.6" id="fields-used-in-property"><span class="header-section-number">3.2.6</span> Fields Used in Property</h3>
<p>This shows the percentage of use of fields in Property.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">field</th>
<th style="text-align: left;">c</th>
<th style="text-align: left;">percentage</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bsdd:allowedValue</td>
<td style="text-align: left;">5059</td>
<td style="text-align: left;">14.4069%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:code</td>
<td style="text-align: left;">35115</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:connectedPropertyCode</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">0.0484%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:countryOfOrigin</td>
<td style="text-align: left;">12727</td>
<td style="text-align: left;">36.2438%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:countryOfUse</td>
<td style="text-align: left;">12089</td>
<td style="text-align: left;">34.4269%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:creatorLanguageCode</td>
<td style="text-align: left;">12401</td>
<td style="text-align: left;">35.3154%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:dataType</td>
<td style="text-align: left;">33273</td>
<td style="text-align: left;">94.7544%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:definition</td>
<td style="text-align: left;">2772</td>
<td style="text-align: left;">7.8941%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:description</td>
<td style="text-align: left;">10132</td>
<td style="text-align: left;">28.8538%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:dimension</td>
<td style="text-align: left;">613</td>
<td style="text-align: left;">1.7457%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:documentReference</td>
<td style="text-align: left;">656</td>
<td style="text-align: left;">1.8681%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:example</td>
<td style="text-align: left;">1084</td>
<td style="text-align: left;">3.0870%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:methodOfMeasurement</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.0085%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:name</td>
<td style="text-align: left;">35115</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:pattern</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.0057%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:physicalQuantity</td>
<td style="text-align: left;">3802</td>
<td style="text-align: left;">10.8273%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:propertyValueKind</td>
<td style="text-align: left;">35115</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:status</td>
<td style="text-align: left;">35115</td>
<td style="text-align: left;">100.0000%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:subdivisionOfUse</td>
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.0085%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:textFormat</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.0028%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:uid</td>
<td style="text-align: left;">4075</td>
<td style="text-align: left;">11.6047%</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:unit</td>
<td style="text-align: left;">6073</td>
<td style="text-align: left;">17.2946%</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:visualRepresentationUri</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.0057%</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select  ?field (count(?field) as ?c)
where {
  ?prop a bsdd:Property.
  ?prop ?field ?value .
  filter (?field != rdf:type &amp;&amp; ?value != &quot;&quot; &amp;&amp; ?value !=&quot;[]&quot;)
} group by ?field order by ?field</code></pre>
<h3 data-number="3.2.7" id="fields-used-in-propertyvalue"><span class="header-section-number">3.2.7</span> Fields Used in PropertyValue</h3>
<p>This shows the percentage of use of fields in PropertyValue (<code>allowedValues</code>).
Note: we have merged the classes <code>PropertyValue</code> and <code>ClassificationPropertyValue</code> into one, because they have exactly the same structure.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">field</th>
<th style="text-align: left;">c</th>
<th style="text-align: left;">Comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">code</td>
<td style="text-align: left;">214122</td>
<td style="text-align: left;">TODO: use this field in the URL</td>
</tr>
<tr class="even">
<td style="text-align: left;">description</td>
<td style="text-align: left;">3751</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">namespaceUri</td>
<td style="text-align: left;">24553</td>
<td style="text-align: left;">TODO: In the rare cases when filled, use this field as URL</td>
</tr>
<tr class="even">
<td style="text-align: left;">value</td>
<td style="text-align: left;">214121</td>
<td style="text-align: left;">Currently use this field in the URL</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
select ?field (count(?field) as ?c) {
  ?prop a bsdd:PropertyValue; ?field ?value
  filter (?field != rdf:type &amp;&amp; ?value != &quot;&quot; &amp;&amp; ?value !=&quot;[]&quot;)
} group by ?field order by ?field</code></pre>
<p>In most PropertyValues, <code>code=value</code> and <code>namespaceUri</code> is not filled.
But there are some exceptions, and we should improve our RDF refactoring logic to take care of that, as described in the table comments above.
For example:</p>
<ul>
<li><code>namespaceUri https://identifier.buildingsmart.org/uri/FTIA/FTIAtie-1.0/prop/verkon-toiminnallinen-kayttotarkoitus/value/vtk01</code></li>
<li>Has <code>code "vtk01"</code> and <code>value "Pituushalkeamien ehkäisy"</code></li>
<li>We made <code>https://identifier.buildingsmart.org/uri/FTIA/FTIAtie-1.0/prop/verkon-toiminnallinen-kayttotarkoitus/Pituushalkeamien ehkäisy</code>
which is invalid URL because it includes a space</li>
<li>Instead, we should have made URL from <code>code</code>, or use <code>namespaceUri</code> directly</li>
</ul>
<h2 data-number="3.3" id="key-fields"><span class="header-section-number">3.3</span> Key Fields</h2>
<p>In this section we look at the distribution of values for key fields that have impact on how data is modeled.
Again, we see that some bSDD features are not really used.</p>
<h3 data-number="3.3.1" id="classificationtype"><span class="header-section-number">3.3.1</span> ClassificationType</h3>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">CLASS</td>
<td style="text-align: left;">30792</td>
</tr>
<tr class="even">
<td style="text-align: left;">COMPOSED_PROPERTY</td>
<td style="text-align: left;">387</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DOMAIN</td>
<td style="text-align: left;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">MATERIAL</td>
<td style="text-align: left;">493</td>
</tr>
<tr class="odd">
<td style="text-align: left;">REFERENCE_DOCUMENT</td>
<td style="text-align: left;">18</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>select ?type (count(*) as ?c)  {
  ?x bsdd:classificationType ?type
} group by ?type order by ?type</code></pre>
<p>Classification is a fairly generic entity, which can designate:</p>
<ul>
<li>CLASS: e.g. a building component, assembly, concept, etc</li>
<li>MATERIAL: a building material</li>
<li>COMPOSED_PROPERTY: a set of properties (we examine one such example below)</li>
</ul>
<p>However, the other values in the table above cannot be justified:</p>
<ul>
<li>DOMAIN: there is a specific entity <code>Domain</code>, so <code>Classification</code> should not have such type</li>
<li>REFERENCE_DOCUMENT: <code>Classification</code> has such a field, and there's a specific entity <code>ReferenceDocument</code>, so <code>Classification</code> should not have such type</li>
</ul>
<h3 data-number="3.3.2" id="propertyvaluekind-of-classificationproperty"><span class="header-section-number">3.3.2</span> PropertyValueKind of ClassificationProperty</h3>
<p>We have listed all possible values in the table, and two of them are not used:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">value</th>
<th style="text-align: left;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">COMPLEX</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">COMPLEX_LIST</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LIST</td>
<td style="text-align: left;">4837</td>
</tr>
<tr class="even">
<td style="text-align: left;">RANGE</td>
<td style="text-align: left;">3490</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SINGLE</td>
<td style="text-align: left;">103239</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>select ?value (count(?value) as ?c) {
  ?prop a bsdd:ClassificationProperty.
  ?prop bsdd:propertyValueKind ?value .
} group by ?value order by ?value</code></pre>
<h3 data-number="3.3.3" id="propertyvaluekind-of-property"><span class="header-section-number">3.3.3</span> PropertyValueKind of Property</h3>
<p>We have listed all possible values in the table, and two of them are not used:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">value</th>
<th style="text-align: left;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">COMPLEX</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">COMPLEX_LIST</td>
<td style="text-align: left;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">LIST</td>
<td style="text-align: left;">1259</td>
</tr>
<tr class="even">
<td style="text-align: left;">RANGE</td>
<td style="text-align: left;">820</td>
</tr>
<tr class="odd">
<td style="text-align: left;">SINGLE</td>
<td style="text-align: left;">33990</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>select ?value (count(?value) as ?c) {
  ?prop a bsdd:Property.
  ?prop bsdd:propertyValueKind ?value .
} group by ?value order by ?value</code></pre>
<h3 data-number="3.3.4" id="status"><span class="header-section-number">3.3.4</span> Status</h3>
<p>Breakdown of main entities by status.</p>
<ul>
<li>Despite the endpoint being listed as "test", most objects are "Active"</li>
<li>We also noticed that some Domains lack any value!</li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">status</th>
<th style="text-align: left;">Classification</th>
<th style="text-align: left;">ClassificationProperty</th>
<th style="text-align: left;">Domain</th>
<th style="text-align: left;">Property</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Active</td>
<td style="text-align: left;">22543</td>
<td style="text-align: left;">107746</td>
<td style="text-align: left;">52</td>
<td style="text-align: left;">34627</td>
</tr>
<tr class="even">
<td style="text-align: left;">Preview</td>
<td style="text-align: left;">9176</td>
<td style="text-align: left;">3819</td>
<td style="text-align: left;">45</td>
<td style="text-align: left;">1441</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">NONE</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">10</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
<p>We used this query, but then changed the table to 2-dimensional:</p>
<pre class="sparql"><code>select ?type ?status (count(*) as ?c) {
  ?x a ?type; bsdd:status ?status
} group by ?type ?status order by ?type ?status</code></pre>
<h3 data-number="3.3.5" id="dynamic-properties"><span class="header-section-number">3.3.5</span> Dynamic Properties</h3>
<p>Dynamic properties are interesting because they are calculated from other properties:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">isDynamic</th>
<th style="text-align: left;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">false</td>
<td style="text-align: left;">135250</td>
</tr>
<tr class="even">
<td style="text-align: left;">true</td>
<td style="text-align: left;">12385</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>select (count(*) as ?c) ?isDynamic where {
  ?d bsdd:isDynamic ?isDynamic
} group by ?type order by desc(?c)</code></pre>
<p>According to the above, nearly 10% of properties are dynamic.
However, <code>dynamicParameterPropertyCodes</code> is always empty, so there is no indication from which properties those would be calculated.</p>
<h3 data-number="3.3.6" id="iswritable-property"><span class="header-section-number">3.3.6</span> isWritable Property</h3>
<p><code>isWritable</code> specifies whether the Property can be edited.
Most Properties don't have such characteristic.
We don't think the default is <code>false</code>, which means that the field is badly under-specified.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">ClassificationProperty</th>
<th style="text-align: left;">Property</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>false</td>
<td style="text-align: left;">4</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td>true</td>
<td style="text-align: left;">1653</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td>UNDEF</td>
<td style="text-align: left;">109909</td>
<td style="text-align: left;">36069</td>
</tr>
</tbody>
</table>
<p>We used this query, but then made a 2-dimensional table:</p>
<pre class="sparql"><code>select ?type ?isWritable (count(*) as ?c) {
  values ?type {bsdd:Property bsdd:ClassificationProperty}
  ?x a ?type.
  optional {?x bsdd:isWritable ?isWritable1}
  bind(coalesce(?isWritable1,&quot;UNDEF&quot;) as ?isWritable)
} group by ?type ?isWritable order by ?type ?isWritable</code></pre>
<h3 data-number="3.3.7" id="isrequired-property"><span class="header-section-number">3.3.7</span> isRequired Property</h3>
<p><code>isRequired</code> specifies whether the Property must be present in an object of the respective Classification.
Similar to the previous section, most Properties don't have such characteristic.
But maybe here <code>false</code> is a suitable default.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th style="text-align: left;">ClassificationProperty</th>
<th style="text-align: left;">Property</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>false</td>
<td style="text-align: left;">2</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td>true</td>
<td style="text-align: left;">1667</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td>UNDEF</td>
<td style="text-align: left;">109897</td>
<td style="text-align: left;">36069</td>
</tr>
</tbody>
</table>
<p>We used this query, but then made a 2-dimensional table:</p>
<pre class="sparql"><code>select ?type ?isRequired (count(*) as ?c) {
  values ?type {bsdd:Property bsdd:ClassificationProperty}
  ?x a ?type.
  optional {?x bsdd:isRequired ?isRequired1}
  bind(coalesce(?isRequired1,&quot;UNDEF&quot;) as ?isRequired)
} group by ?type ?isRequired order by ?type ?isRequired</code></pre>
<h3 data-number="3.3.8" id="domains-with-iswritable-and-isrequired-properties"><span class="header-section-number">3.3.8</span> Domains with isWritable and isRequired Properties</h3>
<p>Let's find all domains that have <code>isWritable</code> and <code>isRequired</code> <code>Properties</code>, and count such properties:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">domain</th>
<th style="text-align: left;">domainName</th>
<th style="text-align: left;">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/bimeta/bimeta-1.0" class="uri">https://identifier.buildingsmart.org/uri/bimeta/bimeta-1.0</a></td>
<td style="text-align: left;">Bauteiltypen nach DIN 276+x (geprüft)</td>
<td style="text-align: left;">1615</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.0" class="uri">https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.0</a></td>
<td style="text-align: left;">Fruit and vegetables</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.1" class="uri">https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.1</a></td>
<td style="text-align: left;">Fruit and vegetables</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/v5/fruitvegs-1.0" class="uri">https://identifier.buildingsmart.org/uri/v5/fruitvegs-1.0</a></td>
<td style="text-align: left;">Fruit and vegetables</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/v5/fruitvegs-v5-5.0" class="uri">https://identifier.buildingsmart.org/uri/v5/fruitvegs-v5-5.0</a></td>
<td style="text-align: left;">Fruit and vegetables</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/LCCrg-1.0" class="uri">https://identifier.buildingsmart.org/uri/acca/LCCrg-1.0</a></td>
<td style="text-align: left;">LCC_RG</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/limlab/PN001-1.1" class="uri">https://identifier.buildingsmart.org/uri/limlab/PN001-1.1</a></td>
<td style="text-align: left;">Ponti_ClassificazioneDegrado</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/alma/TestMaterial-0.4" class="uri">https://identifier.buildingsmart.org/uri/alma/TestMaterial-0.4</a></td>
<td style="text-align: left;">TestMaterial</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/alma/TestMaterial-0.5" class="uri">https://identifier.buildingsmart.org/uri/alma/TestMaterial-0.5</a></td>
<td style="text-align: left;">TestMaterial</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1" class="uri">https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1</a></td>
<td style="text-align: left;">Uniweimar</td>
<td style="text-align: left;">8</td>
</tr>
</tbody>
</table>
<pre class="sparql"><code>select ?domain ?domainName (count(*) as ?c) {
  ?domain a bsdd:Domain; bsdd:name ?domainName; bsdd:classification ?cla.
  ?cla bsdd:classificationProperty ?prop.
  ?prop bsdd:isRequired true; bsdd:isWritable ?true
} group by ?domain ?domainName order by ?domainName</code></pre>
<p>As you can see, the vast majority of <code>isWritable</code> and <code>isRequired</code> Properties are in this Domain:</p>
<ul>
<li><a href="https://identifier.buildingsmart.org/uri/bimeta/bimeta-1.0" class="uri">https://identifier.buildingsmart.org/uri/bimeta/bimeta-1.0</a> "Bauteiltypen nach DIN 276+x (geprüft)".
For example class "421.43 - Abgaswärmetauscher" has property "Hersteller" that <code>isWritable</code> and <code>isRequired</code>.</li>
<li>The rest are 6 test domains, and <code>LCC_RG, Ponti_ClassificazioneDegrado, Uniweimar</code></li>
</ul>
<h1 data-number="4" id="suggested-improvements"><span class="header-section-number">4</span> Suggested Improvements</h1>
<p>In this section we analyze shortcomings of the original bSDD data structuring, and suggest improvements.</p>
<h2 data-number="4.1" id="return-the-same-data-across-apis"><span class="header-section-number">4.1</span> Return the Same Data Across APIs</h2>
<p>We have compared three representations returned by the bSDD server:</p>
<ul>
<li>JSON from the GraphQL API</li>
<li>JSON from the REST (entity) API</li>
<li>RDF from the REST (entity) API</li>
</ul>
<p>Importantly, some objects returned by GraphQL are not returned by the JSON and RDF APIs.
E.g. let's get the classifications of one particular domain:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  domain(namespaceUri:<span class="st">&quot;https://identifier.buildingsmart.org/uri/fvhf/vhf-0.002&quot;</span>) {</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>    classificationSearch {</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>      namespaceUri</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Nearly none of these are available from the JSON or RDF APIs:</p>
<div class="sourceCode" id="cb20" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># JSON API</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://identifier.buildingsmart.org/uri/fvhf/vhf-0.002/class/G5</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="ex">{</span><span class="st">&quot;&quot;</span><span class="ex">:[</span><span class="st">&quot;Classification with namespace URI &#39;https://identifier.buildingsmart.org/uri/fvhf/vhf-0.002/class/G5&#39; not found&quot;</span><span class="ex">]}</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># RDF API</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-Haccept:text</span>/turtle https://identifier.buildingsmart.org/uri/fvhf/vhf-0.002/class/G5</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="ex">{</span><span class="st">&quot;&quot;</span><span class="ex">:[</span><span class="st">&quot;Classification with namespace URI &#39;https://identifier.buildingsmart.org/uri/fvhf/vhf-0.002/class/G5&#39; not found&quot;</span><span class="ex">]}</span></span></code></pre></div>
<p>We selected entities of each class that have the maximum number of filled fields, and compared the results returned by each API.
We found a number of detailed differences, as presented in the <a href="https://docs.google.com/spreadsheets/d/1z_NRMlExlVuqWhBbSErQ9iiDBY4O_fKMd3avV3-NCmo/edit">bSDD data analysis</a> spreadsheet:</p>
<figure id="fig:bsdd-data-analysis-sheet">
<img src="./img/bsdd-data-analysis-sheet.png" />
<figcaption>
Differences between bSDD GraphQL, JSON and RDF Data
</figcaption>
</figure>
<p>There are differences and omissions in some of the formats, as summarized in the table below.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">Entity.field</th>
<th style="text-align: left;">GraphQL</th>
<th style="text-align: left;">JSON API</th>
<th style="text-align: left;">RDF API</th>
<th style="text-align: left;">comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Classification.childs</td>
<td style="text-align: left;">childs</td>
<td style="text-align: left;">parentClassificationReference.namespaceUri</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">GraphQL points to child, JSON points to parent (1)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Classification.domain</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">bsdd:Domain</td>
<td style="text-align: left;">GraphQL and JSON do not return <code>domain</code> whereas RDF returns it</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Classification.domainNamespaceUri</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">domainNamespaceUri</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">GraphQL and RDF do not return <code>domainNamespaceUri</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">Property.domain</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">bsdd:Domain</td>
<td style="text-align: left;">GraphQL and JSON do not return <code>domain</code> whereas RDF returns it</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Property.domainNamespaceUri</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">domainNamespaceUri</td>
<td style="text-align: left;">NONE</td>
<td style="text-align: left;">GraphQL and RDF do not return <code>domainNamespaceUri</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">ClassificationProperty</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">GraphQL and JSON overload the URL and use it for both <code>ClassificationProperty</code> and <code>Property</code> (2)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ClassificationProperty.property</td>
<td style="text-align: left;">namespaceUri</td>
<td style="text-align: left;">namespaceUri</td>
<td style="text-align: left;">propertyNamespaceUri</td>
<td style="text-align: left;">GraphQL and JSON have no real link, just the overloaded URL. The RDF prop is a string, should be URL (3)</td>
</tr>
<tr class="even">
<td style="text-align: left;">ClassificationProperty.classification</td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">classificationProperty</td>
<td style="text-align: left;">RDF prop is misnamed, should be "classification" (4)</td>
</tr>
</tbody>
</table>
<p>Illustrations of the points above:</p>
<ul>
<li>(1) GraphQL field <code>childs</code> appears when one queries for <code>classification (namespaceUri:"...", includeChilds:true)</code>.
It includes a list of children classifications but with simple properties only.</li>
</ul>
<!-- -->
<pre><code>{
  classification(namespaceUri: &quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcWall&quot;, includeChilds: true) {
    name
    code
    namespaceUri
    childs {
      classificationType
      name
    }
  }
}</code></pre>
<p>results in</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;classification&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcWall&quot;</span><span class="fu">,</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcWall&quot;</span><span class="fu">,</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcWall&quot;</span><span class="fu">,</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;childs&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;classificationType&quot;</span><span class="fu">:</span> <span class="st">&quot;CLASS&quot;</span><span class="fu">,</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcWallStandardCase&quot;</span><span class="fu">,</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;classificationType&quot;</span><span class="fu">:</span> <span class="st">&quot;CLASS&quot;</span><span class="fu">,</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcWall.ELEMENTEDWALL&quot;</span><span class="fu">,</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        <span class="er">}}}</span></span></code></pre></div>
<ul>
<li>(1) JSON includes the inverse link (from child to parent), e.g. when one fetches the subclass <code>IfcCableSegmentCABLESEGMENT</code>, one gets a parent link to <code>IfcCableSegment</code></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">curl</span> <span class="er">-s</span> <span class="er">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;referenceCode&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegmentCABLESEGMENT&quot;</span><span class="fu">,</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;parentClassificationReference&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&quot;</span><span class="fu">,</span></span></code></pre></div>
<ul>
<li>(2,3) In GraphQL and JSON payload, <code>ClassificationProperty</code> does not have a distinct URL, and cannot be obtained separately from the <code>Classification</code> in which it lives.
As a consequence, ClassificationProperties are not considered as first-class entities</li>
</ul>
<div class="sourceCode" id="cb24"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="er">//</span> <span class="er">curl</span> <span class="er">-s</span> <span class="er">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;referenceCode&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegmentCABLESEGMENT&quot;</span><span class="fu">,</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;classificationProperties&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ACResistance&quot;</span><span class="fu">,</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyCode&quot;</span><span class="fu">:</span> <span class="st">&quot;ACResistance&quot;</span><span class="fu">,</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyDomainName&quot;</span><span class="fu">:</span> <span class="st">&quot;IFC&quot;</span><span class="fu">,</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyNamespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/ACResistance&quot;</span><span class="fu">,</span></span></code></pre></div>
<ul>
<li>(3) RDF includes the following attribute (string). Instead, it should be a relation (object property), e.g. <code>bsdd:property &lt;prop/ACResistance&gt;</code></li>
</ul>
<pre class="turtle"><code>@base &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/&gt;.
&lt;class/IfcCableSegmentCABLESEGMENT/ACResistance&gt;
  bsdd:PropertyNamespaceUri &quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/ACResistance&quot;.</code></pre>
<ul>
<li>(4) RDF includes the following relation. The source is a <code>ClassificationProperty</code> and the target is a <code>Classification</code>, so the relation should be named <code>classification</code></li>
</ul>
<pre class="turtle"><code>@base &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/&gt;.
&lt;class/IfcCableSegmentCABLESEGMENT/ACResistance&gt;
  bsdd:ClassificationProperty &lt;class/IfcCableSegmentCABLESEGMENT&gt;.</code></pre>
<h2 data-number="4.2" id="improve-property-names"><span class="header-section-number">4.2</span> Improve Property Names</h2>
<p>Property names should conform to naming conventions and be spelled consistently</p>
<ul>
<li>Property (field) names should be spelled in singular, even when they refer to an array.
The arity is reflected in the property kind, e.g. in GraphQL, that's <code>SCALAR</code> vs <code>ARRAY</code>.
For example, <code>String</code> is a scalar string, whereas <code>[String]</code> is an array of strings.</li>
<li>The GraphQL and JSON field <code>childs</code> should be spelled properly as <code>children</code> (unless it's spelled in singular, see above)</li>
<li>RDF properties should conform to the <code>lowerCamelCase</code> convention, i.e. start with a lowercase letter.
Most ontologies conform to this convention, eg see the <a href="https://schema.org/docs/styleguide.html">Schema.org Styleguide</a></li>
<li><code>namespaceUri</code> is a misnomer since "namespace" means a set of URIs sharing the same prefix, but most bSDD URIs are <strong>single</strong> URIs.
URI is a general term that includes both URNs (non-resolvable) and URLs (resolvable).
According to Linked Data principles, it is better to use resolvable URLs.</li>
<li>RDF properties should use one consistent namespace.
Most props use <code>bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;</code>,
except <code>hasReference</code>, which uses a different namespace:
<code>&lt;http://bsdd.buildingsmart.org/relation/def#&gt;</code>.
You can see this problem by fetching:</li>
</ul>
<pre class="example"><code>curl -s -H Accept:text/turtle  https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.0/class/apple</code></pre>
<h2 data-number="4.3" id="use-the-same-url-for-data-and-for-web-pages"><span class="header-section-number">4.3</span> Use the Same URL for Data and for Web Pages</h2>
<p>bSDD has implemented "entity URLs", i.e. for each kind of entity it can return its data in JSON or RDF:</p>
<pre><code>curl -s                      https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT
curl -s -Haccept:text/turtle https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT</code></pre>
<p>Note: to pretty-print the JSON, add this to the end of the command: <code>| jq .</code></p>
<p>The same URL can be used to get a static web page in the browser:
<a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT</a></p>
<figure id="fig:IFC-class-cableSegment-web">
<img src="./img/IFC-class-cableSegment-web.png" />
<figcaption>
CableSegment enity as displayed at the bSDD web site
</figcaption>
</figure>
<p>However, the interactive <a href="https://search.bsdd.buildingsmart.org">bSDD Search</a> UI uses a different URL that returns slightly different information:
<a href="https://search.bsdd.buildingsmart.org/Classification/Index/58453" class="uri">https://search.bsdd.buildingsmart.org/Classification/Index/58453</a></p>
<figure id="fig:IFC-class-cableSegment-search">
<img src="./img/IFC-class-cableSegment-search.png" />
<figcaption>
CableSegment as displayed at the bSDD search site
</figcaption>
</figure>
<p>There is not really a need for two different web pages showing nearly the same info.
We think that with some modest change in technology, the Search UI can use the first (semantic) URL immediately instead of an internal (non-semantic) <code>Index/</code> URL.
Otherwise, there is a danger that people will start copying these non-semantic URLs in communication and (even worse) in AECO data.</p>
<h2 data-number="4.4" id="improve-url-structure-and-consistency"><span class="header-section-number">4.4</span> Improve URL Structure and Consistency</h2>
<p>To facilitate the accessibility of digital artifacts available from bSDD,
their URLs should be designed uniformly according to <a href="https://www.w3.org/DesignIssues/LinkedData.html">Linked Data Principles</a>.
Recommendations on ontology URI design, including versioning and opaque URIs to maintain evolution and multilingualism inherent to bSDD, are described at [<span class="citation" data-cites="GarijoPoveda2020">@GarijoPoveda2020</span>].
Proper bSDD domain URL design should take into account the following observations:</p>
<ul>
<li>Almost all domain URLs have the same structure: <code>https://identifier.buildingsmart.org/uri/&lt;org&gt;/&lt;domain&gt;-&lt;version&gt;</code>.
There are only two exceptions:</li>
</ul>
<!-- -->
<pre><code>http://otl.amsterdam.nl
http://rdf.vegdata.no/V440/v440-owl</code></pre>
<p>The Linked Data Patterns book describes a pattern of <a href="https://patterns.dataincubator.org/book/hierarchical-uris.html">Hierarchical URIs</a>,
that make URLs more "hackable", allowing users to navigate the hierarchy by pruning the URI.
bSDD URLs could become more hierarchical if they follow this structure:</p>
<pre class="example"><code>https://identifier.buildingsmart.org/uri/&lt;org&gt;/&lt;domain&gt;/&lt;version&gt;</code></pre>
<p>Problems:</p>
<ul>
<li>bSDD uses dash not slash to separate the versoion</li>
<li>In some cases, the <code>&lt;org&gt;</code> is repeated in the <code>&lt;domain&gt;</code> part</li>
<li>In some cases, the <code>&lt;org&gt;</code> name doesn't quite mesh with the domain name, perhaps due to the way bSDD allocates <code>&lt;org&gt;</code> identifiers to bSDD contributors
<ul>
<li>"bim-de/DINSPEC91400": the publisher of this spec is DIN (the German standards organization), not the <code>bim-de</code> initiative</li>
<li>"digibase/volkerwesselsbv": <a href="https://www.bimregister.nl/actueel/video/author/89-delanokenepa?start=250">bimregister.nl news from 2018</a> suggest that <code>digibase</code> is a new company/initaitive within Volker Wessel</li>
<li>"digibase/nen2699": the publisher of this spec is NEN (the Netherlands standards organization), not the <code>digibase</code> company/initiative</li>
<li>"digibase/digibasebouwlagen": perhaps the org name <code>digibase</code> should not be repeated as the prefix of the domain <code>bouwlagen</code> (building layers)</li>
</ul></li>
<li>A few domains use <code>http</code> whereas all others use <code>https</code>. All modern servers prefer <code>https</code> due to its better security.</li>
</ul>
<!-- -->
<pre><code>http://identifier.buildingsmart.org/uri/spr/spr-cfhios-0.1
http://otl.amsterdam.nl
http://rdf.vegdata.no/V440/v440-owl</code></pre>
<h3 data-number="4.4.1" id="explicate-domain-versions"><span class="header-section-number">4.4.1</span> Explicate Domain Versions</h3>
<p>bSDD includes multiple versions of some domains.
For example, here are all <code>ACCAtest</code> domain versions:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">dom</th>
<th style="text-align: left;">ver</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.1" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.1</a></td>
<td style="text-align: left;">0.1</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.35" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.35</a></td>
<td style="text-align: left;">0.35</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.40" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.40</a></td>
<td style="text-align: left;">0.40</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.41" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.41</a></td>
<td style="text-align: left;">0.41</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-1.0" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-1.0</a></td>
<td style="text-align: left;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-8.0" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-8.0</a></td>
<td style="text-align: left;">8.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-9.0" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-9.0</a></td>
<td style="text-align: left;">9.0</td>
</tr>
</tbody>
</table>
<p>This was obtained with this SPARQL query:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
PREFIX xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;
select * {
  ?dom bsdd:version ?ver
  filter(contains(str(?dom),&quot;ACCAtest&quot;))
} order by xsd:decimal(?ver)</code></pre>
<p>We have seen no guidance how version numbers should be formatted.</p>
<ul>
<li>If they are decimal number, they should be recorded with type <code>xsd:decimal</code> so they can be compared and sorted
(we cast them to that datatype in the query above)</li>
<li>But if they can have more decimal components (e.g. <code>1.0.1</code>) then they should not be recorded as <code>xsd:decimal</code></li>
</ul>
<p>We believe it is worth explicating versions:</p>
<ul>
<li>Either as <code>Domain</code> relations such as <code>previousVersion, nextVersion</code></li>
<li>Or as a new entity <code>DomainVersion</code>, to allow linking all versions of a domain to its master <code>Domain</code> entity</li>
</ul>
<h3 data-number="4.4.2" id="declare-urls-to-be-id-and-use-a-mandatory-field-id"><span class="header-section-number">4.4.2</span> Declare URLs to be <code>ID</code> and Use a Mandatory Field <code>id</code></h3>
<p>The <a href="https://spec.graphql.org/draft/#sec-ID">GraphQL specification sec 3.5.5 ID</a> states:
"The <code>ID</code> scalar type represents a unique identifier,
often used to re-fetch an object or as the key for a cache."
This data type is similar to <code>String</code>, but is specifically used for identifiers.</p>
<p>Furthermore, the <a href="https://graphql.org/learn/global-object-identification/#node-interface">Global Object Identification Guide for GraphQL</a> recommends
that a;; objects should have a field <code>id</code> that returns non-null <code>ID!</code> (through the <code>Node</code> interface).
The <code>id</code> should be a "globally unique identifier" for the object,
and given just this <code>id</code>, the server should be able to re-fetch that object.</p>
<ul>
<li>Most GraphQL implementations call this field simply <code>id</code>, whereas bSDD uses unwieldy property names like <code>namespaceUri</code>.</li>
<li>Many nodes do not have their own <code>namespaceUri</code> field, or it is not fully populated</li>
</ul>
<h3 data-number="4.4.3" id="overlap-of-entity-classes-with-classificationtype"><span class="header-section-number">4.4.3</span> Overlap of Entity Classes with <code>classificationType</code></h3>
<p>The key field <code>classificationType</code> specifies the kind of classification. Let's do a count:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select (count(*) as ?c) ?type where {
  ?d bsdd:classificationType ?type
} group by ?type order by desc(?c)</code></pre>
<p>Here are the results, and we see that some <code>classificationType</code> overlap with predefined entity types:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">c</th>
<th style="text-align: left;">type</th>
<th style="text-align: left;">overlaps with</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">29434</td>
<td style="text-align: left;">"CLASS"</td>
<td style="text-align: left;">ok</td>
</tr>
<tr class="even">
<td style="text-align: left;">489</td>
<td style="text-align: left;">"MATERIAL"</td>
<td style="text-align: left;">ok</td>
</tr>
<tr class="odd">
<td style="text-align: left;">387</td>
<td style="text-align: left;">"COMPOSED_PROPERTY"</td>
<td style="text-align: left;">see next section</td>
</tr>
<tr class="even">
<td style="text-align: left;">29</td>
<td style="text-align: left;">"DOMAIN"</td>
<td style="text-align: left;"><code>Domain</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">18</td>
<td style="text-align: left;">"REFERENCE_DOCUMENT"</td>
<td style="text-align: left;"><code>ReferenceDocument</code></td>
</tr>
</tbody>
</table>
<p>We can examine some of these unusual classifications with this query:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select ?x ?name ?type {
  ?x a bsdd:Classification; bsdd:classificationType ?type; bsdd:name ?name
  filter(?type not in (&quot;CLASS&quot;, &quot;MATERIAL&quot;))
}</code></pre>
<p>Examples of unusual classifications:</p>
<ul>
<li><a href="https://identifier.buildingsmart.org/uri/ATALANE/REX-OBJ-1.0/class/589b06ad-f802-468b-939c-e60436601a7a" class="uri">https://identifier.buildingsmart.org/uri/ATALANE/REX-OBJ-1.0/class/589b06ad-f802-468b-939c-e60436601a7a</a>
is a "REFERENCE_DOCUMENT" with name "décret 2011-321 (23/03/2011)".
Why is it not a <code>ReferenceDocument</code> entity?</li>
<li><a href="https://identifier.buildingsmart.org/uri/acca/AASHTO-1.0/class/06" class="uri">https://identifier.buildingsmart.org/uri/acca/AASHTO-1.0/class/06</a>
is a "DOMAIN" with name "Bridge Superstructure".
This reflects the hierarchical nature of the AASHTO-1.0 classification, which we can see clearly with the following query.
But bSDD accommodates classification hierarchies, so why "Bridge Superstructure" is "DOMAIN" and not "CLASS"?</li>
</ul>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select ?code ?name ?type where {
  ?x a bsdd:Classification; bsdd:name ?name; bsdd:code ?code; bsdd:classificationType ?type.
  filter(strstarts(str(?x),&quot;https://identifier.buildingsmart.org/uri/acca/AASHTO-1.0/class/06&quot;))
} order by ?code</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">code</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">06</td>
<td style="text-align: left;">Bridge Superstructure</td>
<td style="text-align: left;">DOMAIN</td>
</tr>
<tr class="even">
<td style="text-align: left;">06.01</td>
<td style="text-align: left;">Bearing</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">06.02</td>
<td style="text-align: left;">Curb</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="even">
<td style="text-align: left;">06.03</td>
<td style="text-align: left;">Deck</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">06.04</td>
<td style="text-align: left;">Deck Drain</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="even">
<td style="text-align: left;">06.05</td>
<td style="text-align: left;">Deck Joints</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">06.06</td>
<td style="text-align: left;">Haunch</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="even">
<td style="text-align: left;">06.07</td>
<td style="text-align: left;">Girder</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">06.08</td>
<td style="text-align: left;">Median</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="even">
<td style="text-align: left;">06.09</td>
<td style="text-align: left;">Parapet (Barrier)</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">06.10</td>
<td style="text-align: left;">Railing</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="even">
<td style="text-align: left;">06.11</td>
<td style="text-align: left;">Sidewalk</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="odd">
<td style="text-align: left;">06.12</td>
<td style="text-align: left;">Sound Wall (Barrier)</td>
<td style="text-align: left;">CLASS</td>
</tr>
<tr class="even">
<td style="text-align: left;">06.13</td>
<td style="text-align: left;">Transverse Member</td>
<td style="text-align: left;">CLASS</td>
</tr>
</tbody>
</table>
<p>We can posit (guess) two reasons for this structural problem:</p>
<ul>
<li>The bSDD data model does not provide a way to model sub-domains or attach reference documents to specific domains</li>
<li>Some bSDD data contributors use <code>Classification</code> as a "dump" of all kinds of data, not just single entities</li>
</ul>
<h3 data-number="4.4.4" id="property-vs-classificationproperty-use-distinct-urls"><span class="header-section-number">4.4.4</span> Property vs ClassificationProperty: Use Distinct URLs</h3>
<p><code>Property</code> and <code>ClassificationProperty</code> are two different classes, but the latter does not have a distinct URL in GraphQL and JSON.
The same URL is overloaded to identify entities of both classes.
<code>ClassificationProperty</code> are thus "second class" entities and are not returned separately by the JSON or RDF entity API,
but only as part of the respective <code>Classification</code>:</p>
<pre><code>curl https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT/ACResistance
{&quot;&quot;:[&quot;Classification with namespace URI
 &#39;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT/ACResistance&#39;
  not found&quot;]}</code></pre>
<p><code>ClassificationProperty</code> is identified only in RDF since this format forces one to use different identities for different nodes:</p>
<pre class="turtle"><code>&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT/ACResistance&gt;
  bsdd:ClassificationProperty &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT&gt;;
  bsdd:PropertyDomainName &quot;IFC&quot;;
  bsdd:PropertyNamespaceUri &quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/ACResistance&quot;.</code></pre>
<h3 data-number="4.4.5" id="all-entities-should-have-url"><span class="header-section-number">4.4.5</span> All Entities Should Have URL</h3>
<p>Following the thinking of the previous section, all significant classes should have <code>ID</code>,
(which in the case of RDF data is the node URL).</p>
<p>However, many bSDD classes don't have such a field:</p>
<ul>
<li><code>Domain, Property, Classification</code> do have <code>namespaceUri</code></li>
<li><code>Country, Language, Unit</code> don't have an ID but have a field (<code>code, isocode</code>)
that can be used to make an <code>ID</code>, when prepended with an appropriate prefix.
However, <code>Unit.code</code> is not always fit to be used in a URL</li>
<li><code>ClassificationProperty</code> doesn't have an ID in GraphQL.
We follow the bSDD RDF representation and assign a URL
from the URL of the owning object (<code>Classification</code>) and its own <code>propertyCode</code>:</li>
</ul>
<pre class="example"><code> Classification.namespaceUri+&quot;/&quot;+propertyCode</code></pre>
<ul>
<li><code>PropertyValue, ClassificationPropertyValue</code> have <code>namespaceUri</code>
but it's optional and is rarely filled.
We assign URLs similarly to the previous case:
from the URL of the owning object and its <code>value</code>:</li>
</ul>
<pre class="example"><code>Property.namespaceUri+&quot;/&quot;+value OR
ClassificationProperty.namespaceUri+&quot;/&quot;+value</code></pre>
<ul>
<li>The following classes have no fields suitable to make a URL, so they remain blank nodes:
<ul>
<li><code>ReferenceDocument</code>: only <code>name, title, date</code></li>
<li><code>ClassificationRelation</code>: a pair of <code>related</code> Classifications, no own URL</li>
<li><code>PropertyRelation</code>: a pair of <code>related</code> Properties, no own URL</li>
</ul></li>
</ul>
<p>For example, the classification shown below has <code>ClassificationProperties</code> with no <code>propertyCode</code></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;namespaceUri&quot;:</span> <span class="er">&quot;https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/class/Nondestructive&quot;,</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;properties&quot;:</span> <span class="ot">[</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Identifier of the tested structure&quot;</span><span class="fu">,</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;isRequired&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;isWritable&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;predefinedValue&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Single&quot;</span><span class="fu">,</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;__typename&quot;</span><span class="fu">:</span> <span class="st">&quot;ClassificationProperty&quot;</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="er">...</span><span class="ot">]</span></span></code></pre></div>
<h2 data-number="4.5" id="modeling-issues"><span class="header-section-number">4.5</span> Modeling Issues</h2>
<p>In addition to the technical recommendations above (to ease findability and accessibility of data in bSDD by improving URls),
we have noticed several modeling issues.</p>
<h3 data-number="4.5.1" id="modeling-of-complex-properties"><span class="header-section-number">4.5.1</span> Modeling of Complex Properties</h3>
<p>The bSDD data model allows the modeling of complex properties that are composed of other properties:
The key attribute <code>propertyValueKind</code> has values COMPLEX and COMPLEX_LIST used in combination with <code>connectedProperties</code>.</p>
<ul>
<li>These key values are defined for <code>Property</code> and <code>ClassificationProperty</code></li>
<li>However, <code>connectedPropertyCodes</code> is defined only for <code>Property</code></li>
<li>More importantly, these key values are never used</li>
</ul>
<p><code>connectedProperty</code> is used only on seven <code>Properties</code> (and not <code>ClassificationProperties</code>):</p>
<pre class="sparql"><code>select ?prop (group_concat(?code) as ?connectedPropCodes) where {
  ?prop  bsdd:connectedPropertyCode ?code
} group by ?prop</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">prop</th>
<th style="text-align: left;">connectedPropCodes</th>
<th style="text-align: left;">comments</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.0/prop/volume" class="uri">https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.0/prop/volume</a></td>
<td style="text-align: left;">"height depth width diameter"</td>
<td style="text-align: left;">Just a sample, not a real domain</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.1/prop/volume" class="uri">https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.1/prop/volume</a></td>
<td style="text-align: left;">"height depth width diameter"</td>
<td style="text-align: left;">Just a sample, not a real domain</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/TestObjective" class="uri">https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/TestObjective</a></td>
<td style="text-align: left;">"ComponentID StructureID"</td>
<td style="text-align: left;">TestObjective relates to ComponentID and StructureID</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/ExpansionWave" class="uri">https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/ExpansionWave</a></td>
<td style="text-align: left;">"Frequency"</td>
<td style="text-align: left;">Seems the connection should be symmetric, why is it not?</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/CPicture" class="uri">https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/CPicture</a></td>
<td style="text-align: left;">"BPicture APicture"</td>
<td style="text-align: left;">A complete cluster of 3 connected props</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/BPicture" class="uri">https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/BPicture</a></td>
<td style="text-align: left;">"CPicture APicture"</td>
<td style="text-align: left;">A complete cluster of 3 connected props</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/APicture" class="uri">https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/APicture</a></td>
<td style="text-align: left;">"CPicture BPicture"</td>
<td style="text-align: left;">A complete cluster of 3 connected props</td>
</tr>
</tbody>
</table>
<p>The meaning of <code>connectedPropertyCodes</code> is not defined:</p>
<ul>
<li>Is it a symmetric/equivalence relation between properties?</li>
<li>Or is it used to point from a "master" property to its "subsidiary properties"?</li>
</ul>
<p>The examples don't clarify this question.</p>
<p>Instead of using <code>connectedPropertyCode</code> to describe complex properties, some people have used classifications with the type "COMPOSED_PROPERTY".
One such example is <a href="https://identifier.buildingsmart.org/uri/buildingsmart-fr/BRIDGE-MINnD-1.0/class/609952491" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart-fr/BRIDGE-MINnD-1.0/class/609952491</a>
with name "Pile location" and definition "Gather properties to locate a pile".
We can see the properties comprising this "COMPOSED_PROPERTY" by using the link <code>Classification.classificationProperty</code>:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select ?type ?code ?name ?def {
  bind(&lt;https://identifier.buildingsmart.org/uri/buildingsmart-fr/BRIDGE-MINnD-1.0/class/609952491&gt; as ?class)
  {bind(?class as ?x)} union {?class bsdd:classificationProperty ?x}
  ?x a ?type; bsdd:code ?code; bsdd:name ?name
  optional {?x bsdd:definition ?def}
}</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">code</th>
<th style="text-align: left;">name</th>
<th style="text-align: left;">def</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bsdd:Classification</td>
<td style="text-align: left;">609952491</td>
<td style="text-align: left;">Pile location</td>
<td style="text-align: left;">Gather properties to locate a pile</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:ClassificationProperty</td>
<td style="text-align: left;">PR277312330</td>
<td style="text-align: left;">Elevation at the bottom of pile</td>
<td style="text-align: left;">Height at the bottom of the pile</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:ClassificationProperty</td>
<td style="text-align: left;">PR1084319020</td>
<td style="text-align: left;">Elevation at the top of pile</td>
<td style="text-align: left;">Height at the top of the pile</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:ClassificationProperty</td>
<td style="text-align: left;">PR1964355937</td>
<td style="text-align: left;">Skew angle at pile location</td>
<td style="text-align: left;">Angle between the bridge axis and the pile axis</td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:ClassificationProperty</td>
<td style="text-align: left;">PR993801653</td>
<td style="text-align: left;">Station at pile location</td>
<td style="text-align: left;">Curvilinear abscissa at pile location</td>
</tr>
</tbody>
</table>
<h3 data-number="4.5.2" id="modeling-of-dynamic-properties"><span class="header-section-number">4.5.2</span> Modeling of Dynamic Properties</h3>
<p>12385 <code>Properties</code> are declared as <code>isDynamic</code> (135250 are not).
However, the field <code>dynamicParameterPropertyCode</code> is always empty, so one</p>
<pre class="sparql"><code>select * {
  ?prop bsdd:isDynamic true.
  optional {?prop bsdd:dynamicParameterPropertyCode ?dyn}
} order by desc(?dyn)</code></pre>
<p>Additionally, <code>dynamicParameterPropertyCodes</code> is <code>String</code>, but should be <code>[Property]</code>, i.e. an array of <code>Properties</code> used to compute the dynamic property.</p>
<h3 data-number="4.5.3" id="improve-relations-between-entities"><span class="header-section-number">4.5.3</span> Improve Relations Between Entities</h3>
<p>bSDD includes numerous string attributes (codes or URLs) that should be converted to relations (object fields) to improve the connectedness of the bSDD has many string attributes (codes or URLs) that should be converted to the relations (object fields) to improve the connectedness of the GraphQL graph.</p>
<ul>
<li><code>ClassificationRelation</code> and <code>PropertyRelation</code> do not have any outgoing relations. Instead, they use strings (e.g. <code>relatedPropertyUri</code>), thus blocking further GraphQL navigation.</li>
<li>There are several entities (<code>Country, Language, ReferenceDocument, Unit</code>) that are not used anywhere.
Instead of relations pointing to these types, the other types have properties (e.g. <code>countryOfOrigin</code>, <code>countriesOfUse</code>) representing the same information as <code>String</code>.</li>
</ul>
<p>Problems related to this approach:</p>
<ul>
<li>One cannot easily navigate in the GraphQL graph.
e.g. to find the country name for <code>countriesOfUse: ["BG"]</code>, one needs to make a second query, get all countries, and look for that code.</li>
<li>It represents data denormalization that creates opportunities for data inconsistency or redundancy,
e.g. if <code>countriesOfUse</code> includes a code "XX" not defined in <code>Country</code>, is that a mistake, or is <code>Country</code> just an advisory table?</li>
</ul>
<p>Here is a list of all strings that are candidates to be converted to object properties (relations). <code>[Foo]</code> indicates an array (multivalued property):</p>
<ul>
<li><code>connectedPropertyCodes</code>: should become <code>[Property]</code></li>
<li><code>countriesOfUse</code>: should become <code>[Country]</code></li>
<li><code>countryOfOrigin</code>: should become <code>Country</code></li>
<li><code>creatorLanguagecode</code>: should become <code>Language</code></li>
<li><code>documentReference</code>: unclear whether it should be a URL, a bibliographic reference, a title, or some other free text. Should become <code>ReferenceDocument</code></li>
<li><code>dynamicParameterPropertyCodes</code>: should become <code>[Property]</code></li>
<li><code>example</code> "Illustrate possible use or values of the Property": could become <code>PropertyValue</code> if it's used consistently to show an example value (not a free text)</li>
<li><code>languageCode</code>: should become <code>Language</code></li>
<li><code>physicalQuantity</code>: could become a separate entity, since it governs what possible <code>units</code> are allowed. See detailed analysis of units later on</li>
<li><code>predefinedValue</code>: should become <code>PropertyValue</code>.
Actually this is a more difficult point because a predefined value could be a number thus not represented as <code>PropertyValue</code>.</li>
<li><code>propertySet</code>: should be made an entity, it's too important to be a mere string</li>
<li><code>relatedClassificationUri</code>: should become <code>Classification</code> (in our refactoring, we rename it to simply <code>related</code> to use the same name for both kinds of relation)</li>
<li><code>relatedIfcEntityNames</code>: since IFC is present as a bSDD Domain, should become a relation to the respective IFC Classification.</li>
<li><code>relatedPropertyUri</code>: should become <code>Property</code> (in our refactoring, we rename it to simply <code>related</code> to use the same name for both kinds of relation)</li>
<li><code>replacedObjectCodes, replacingObjectCodes</code>: should become some kind of objects. But because the field is never filled, we cannot tell what kind of objects</li>
<li><code>subdivisionsOfUse</code>: should be made an entity and become <code>[CountrySubdivision]</code>:
Just like the entity <code>Country</code> should be used as a lookup table for <code>countriesOfUse</code>.
Furthermore, subdivisions are subjugated to countries, so each <code>CountrySubdivision</code> must have a relation to its parent <code>Country</code></li>
<li><code>units</code>: should become <code>[Unit]</code></li>
</ul>
<h3 data-number="4.5.4" id="add-more-entities"><span class="header-section-number">4.5.4</span> Add More Entities</h3>
<p>Summarizing findings from previous sections, we recommend creating the following as additional first-class entities:</p>
<ul>
<li><code>CountrySubdivision</code>: as lookup for <code>subdivisionsOfUse</code>, subjugated to <code>Country</code></li>
<li><code>DomainVersion</code>: to explicitly relate domain versions to each other, and to a master <code>Domain</code> entity</li>
<li><code>PhysicalQuantity</code>: to govern allowed <code>Units</code>, and to be subjugated to the <code>dimension*</code> fields</li>
<li><code>PropertySet</code>: important concept in both IFC and bSDD</li>
</ul>
<h3 data-number="4.5.5" id="use-class-inheritance"><span class="header-section-number">4.5.5</span> Use Class Inheritance</h3>
<p>The following types are very similar, and most of their fields are duplicated between them, with no modularity or inheritance:</p>
<ul>
<li><code>PropertyValue</code> and <code>ClassificationPropertyValue</code>: in fact are the same.
These are "value objects" (simple immutable objects), so there's no need to have two different types.</li>
<li><code>Property</code> and <code>ClassificationProperty</code>.
They differ by only 5 fields:
<ul>
<li><code>connectedPropertyCodes</code> (String) and <code>relations</code> (PropertyRelation) belong uniquely to <code>Property</code></li>
<li><code>isRequired</code> (Boolean), <code>isWritable</code> (Boolean), <code>predefinedValue</code> (String), <code>propertySet</code> (String) and <code>symbol</code> (String) below uniquely to <code>ClassificationProperty</code>.</li>
</ul></li>
</ul>
<p><code>Property</code> is a general property definition, while <code>ClassificationProperty</code> is a property modified locally to a <code>Classification</code>.
But since there are no rules on which fields of <code>Property</code> to reuse in <code>ClassificationProperty</code>,
the latter type copies most of the fields from the former.</p>
<p>For example, the property <a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/HandicapAccessible" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/HandicapAccessible</a>
"Indication that this object is designed to be accessible by the handicapped"
is used for all kinds of spaces, as indicated by its <code>propertySet</code> "Pset_SpaceCommon".
There are over 300 Classisifaction Propertiess that use the indicated property:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select ?propName ?class ?className ?classPropName where {
  bind(&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/HandicapAccessible&gt; as ?prop)
  ?prop bsdd:name ?propName.
  ?classProp bsdd:property ?prop; bsdd:name ?classPropName.
  ?class bsdd:classificationProperty ?classProp; bsdd:name ?className
} order by ?className</code></pre>
<p>Note: a lot of these are duplicated between the two domains <code>acca/ACCAtest-0.1, molio/cciconstruction-1.0</code>, eg:</p>
<ul>
<li><a href="https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.1/class/A-FAA" class="uri">https://identifier.buildingsmart.org/uri/acca/ACCAtest-0.1/class/A-FAA</a> vs</li>
<li><a href="https://identifier.buildingsmart.org/uri/molio/cciconstruction-1.0/class/A-FAA" class="uri">https://identifier.buildingsmart.org/uri/molio/cciconstruction-1.0/class/A-FAA</a></li>
</ul>
<p>The problem is that all these ClassificationProperties copy the same field values from the Property, over and over again:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select ?className ?classPropName ?field ?value1 ?value2 where {
  bind(&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/HandicapAccessible&gt; as ?prop)
  ?classProp bsdd:property ?prop; bsdd:name ?classPropName.
  ?class bsdd:classificationProperty ?classProp; bsdd:name ?className.
  ?prop ?field ?value1.
  ?classProp ?field ?value2.
  filter(?field not in (rdf:type))
  filter(?value1 != ?value2)
}</code></pre>
<p>We also investigated the same problems across ****all**** props.
We ended up with a lot more complicated query:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
select ?className ?classPropName ?field ?value1 ?value2 where {
  ?classProp bsdd:property ?prop; bsdd:name ?classPropName.
  ?class bsdd:classificationProperty ?classProp; bsdd:name ?className.
  optional {?prop ?field ?val1}
  optional {?classProp ?field ?val2}
  filter(?field not in (rdf:type, bsdd:allowedValue, bsdd:connectedPropertyCode,
                        bsdd:countryOfUse, bsdd:name, bsdd:description, bsdd:textFormat))
  bind(replace(str(?val1),&quot;[ \\n\\t]*(.*?)[ \\n\\t]*&quot;,&quot;$1&quot;) as ?value1)
  bind(replace(str(?val2),&quot;[ \\n\\t]*(.*?)[ \\n\\t]*&quot;,&quot;$1&quot;) as ?value2)
  filter(!bound(?value1) || !bound(?value2) || ?value1 != ?value2)
}</code></pre>
<p>It does the following:</p>
<ul>
<li>Allows for differences of optional fields, i.e. present in Property but missing in ClassificationProperty or vice versa</li>
<li>Trims leading and trailing whitespace from field values (see next section)</li>
<li>Ignores <code>rdf:type</code> because it's naturally different (<code>bsdd:Property</code> vs <code>bsdd:ClassificationProperty</code>)</li>
<li>Ignores <code>bsdd:name, bsdd:description</code> because minor variations are often present. Example for <code>bsdd:name</code> are:
"Inhalt(Menge)jeBestelleinheit" vs "Inhalt<sub>(Menge)</sub>_je_Bestelleinheit"</li>
<li>Ignores <code>bsdd:allowedValue, bsdd:connectedPropertyCode, bsdd:countryOfUse</code> because these multi-valued fields are not so easy to compare (separate queries would be needed for this)</li>
<li>Ignores <code>bsdd:textFormat</code> because we saw only invalid values, such as "" and "F.001"</li>
</ul>
<p>Valid changes include:</p>
<ul>
<li><code>min/maxInclusive/Exclusive</code>: e.g. "Height" is defined to have a valid range 0..5000, but in the class "Apple" it's restricted to 1..25.
However, we have seen this only in sample domains.</li>
<li><code>unit</code>, e.g. from "m" to "mm" or "cm." Ideally, this should happen if the <code>physicalQuantity</code> and <code>dimension</code> are preserved but it is often not the case:
<ul>
<li>"Pitting": "Profondità in media": unit "²" vs "mm" (which is invalid).</li>
<li>"Pitting": "Entità del fenomeno (sup)": unit "m" vs "m²".
It seems there is an uncertainty how surface defects (pitting, erosion, patina) should be measured: as length/diameter or as area.</li>
</ul></li>
</ul>
<h3 data-number="4.5.6" id="improve-description-of-classificationproperties"><span class="header-section-number">4.5.6</span> Improve Description of ClassificationProperties</h3>
<p>Perhaps because there is no clearly defined distinction between global properties (<code>Property</code>) and local properties (<code>ClassificationProperty</code>),
and there are no rules on what fields they can inherit from one to the other, several local properties lack adequate descriptions.
For example, let's look at the local property <code>Status</code> in classification <a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox">IfcAirTerminalBox</a>:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;name&quot;:</span> <span class="er">&quot;Status&quot;,</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;description&quot;:</span> <span class="er">&quot;The</span> <span class="er">status</span> <span class="er">currently</span> <span class="er">assigned</span> <span class="er">to</span> <span class="er">the</span> <span class="er">permit.&quot;,</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;propertyCode&quot;:</span> <span class="er">&quot;Status&quot;,</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;propertyNamespaceUri&quot;:</span> <span class="er">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/Status&quot;,</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;propertySet&quot;:</span> <span class="er">&quot;Pset_AirTerminalBoxTypeCommon&quot;,</span></span></code></pre></div>
<p>The local definition refers to an appropriate propertySet <code>Pset_AirTerminalBoxTypeCommon</code>,
but the <code>description</code> is not suitable to that classification (an "AirTerminalBox" is not a "permit"!).</p>
<h3 data-number="4.5.7" id="improve-representation-of-propertyvalues"><span class="header-section-number">4.5.7</span> Improve Representation of PropertyValues</h3>
<p><code>PropertyValue</code> and <code>ClassificationPropertyValue</code> are structured values with rich fields: <code>code, value, namespaceUri, description, sortNumber</code>.
These fields allow:</p>
<ul>
<li>Unique identification of values through <code>namespaceUri</code></li>
<li>Potentially multilingual translations in the future (if <code>value, description</code> are made multivalued and attached a language tag)</li>
<li>The logical ordering of values through <code>sortNumber</code> (as opposed to alphabetical ordering)</li>
</ul>
<p>However, most structured values we've seen have only <code>code, value</code></p>
<p>For example, consider this property:</p>
<div class="sourceCode" id="cb48" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/ArrangementType</span></code></pre></div>
<p>Its <code>description</code> includes not just a property description, but is followed by descriptions of values (newline-separated):</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>      <span class="er">&quot;name&quot;:</span> <span class="er">&quot;ArrangementType&quot;,</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>      <span class="er">&quot;description&quot;:</span> <span class="er">&quot;Terminal</span> <span class="er">box</span> <span class="er">arrangement.\n\</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="er">SingleDuct:</span> <span class="er">Terminal</span> <span class="er">box</span> <span class="er">receives</span> <span class="er">warm</span> <span class="er">or</span> <span class="er">cold</span> <span class="er">air</span> <span class="er">from</span> <span class="er">a</span> <span class="er">single</span> <span class="er">air</span> <span class="er">supply</span> <span class="er">duct.\n\</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="er">DualDuct:</span> <span class="er">Terminal</span> <span class="er">box</span> <span class="er">receives</span> <span class="er">warm</span> <span class="er">and</span> <span class="er">cold</span> <span class="er">air</span> <span class="er">from</span> <span class="er">separate</span> <span class="er">air</span> <span class="er">supply</span> <span class="er">ducts.&quot;,</span></span></code></pre></div>
<p>The same property when used in classification <a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox">IfcAirTerminalBox</a> has values described like this:</p>
<pre class="sparql"><code>select * {
  &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType&gt; bsdd:allowedValue ?val.
  ?val bsdd:code ?code;
       # bsdd:value ?value # same as &quot;code&quot;
} order by ?code</code></pre>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">val</th>
<th style="text-align: left;">code</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/DUALDUCT" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/DUALDUCT</a></td>
<td style="text-align: left;">DUALDUCT</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/NOTKNOWN" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/NOTKNOWN</a></td>
<td style="text-align: left;">NOTKNOWN</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/OTHER" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/OTHER</a></td>
<td style="text-align: left;">OTHER</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/SINGLEDUCT" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/SINGLEDUCT</a></td>
<td style="text-align: left;">SINGLEDUCT</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/UNSET" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox/ArrangementType/UNSET</a></td>
<td style="text-align: left;">UNSET</td>
</tr>
</tbody>
</table>
<p>This has multiple problems:</p>
<ul>
<li>Individual values have no description (<code>description</code> is not filled out)</li>
<li>Some values are described in the property definition, intermingling multiple descriptions together</li>
<li>The "standard" values NOTKNOWN, OTHER, UNSET are not described at all.</li>
<li>Values have no <code>namespaceUri</code>, precluding unique identification.</li>
</ul>
<h3 data-number="4.5.8" id="improve-representation-of-predefinedvalue"><span class="header-section-number">4.5.8</span> Improve Representation of predefinedValue</h3>
<p><code>allowedValues</code> (and its deprecated variant <code>possibleValues</code>) store structured values (<code>ClassificationPropertyValue</code>).
However, their "sibling" property <code>predefinedValue</code> holds a mere string and not a structured value, which means that even in the future, <code>predefinedValue</code> cannot be an enumeration value identified globally with a URL.
We could think of two possible reasons for this discrepancy:</p>
<ul>
<li><code>predefinedValue</code> needs to hold not just enumeration values but also Real, String, Boolean, etc.
Then it should be structured as a variant and not be cast down to String.</li>
<li>It may be related to the poor description of PropertyValue</li>
</ul>
<h3 data-number="4.5.9" id="improve-multilingual-support"><span class="header-section-number">4.5.9</span> Improve Multilingual Support</h3>
<p>bSDD is advertised as a multilingual dictionary.
In the GraphQL API, one can specify a desired language when fetching classifications and properties:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>classification(includeChilds: <span class="dt">Boolean</span>, languageCode: <span class="dt">String</span>, namespaceUri: <span class="dt">String</span>!) {...}</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>property(languageCode: <span class="dt">String</span>, namespaceUri: <span class="dt">String</span>!) {...}</span></code></pre></div>
<p>However, each domain seems to be present in one language only (<strong>unilingual</strong>).
When you fetch a Classification or Property from the REST API:</p>
<ul>
<li>Text properties like <code>name</code> and <code>description</code> are single-valued and present in one language only</li>
<li>There's a single-valued prop <code>creatorLanguageCode</code></li>
<li>Unlike <code>rdf:langString</code> that are self-describing (e.g. <code>"wall"@en</code> vs <code>"wand"@de</code>),
bSDD text fields do not carry a lang code with them</li>
</ul>
<p>In contrast, <a href="https://platform.ontotext.com/semantic-objects/tutorials/graphql-query.html#filtering-literal-values">Ontotext Platform Semantic Objects</a> includes comprehensive facilities for selecting labels per language, including language fallback.</p>
<h2 data-number="4.6" id="improve-rdf-structure"><span class="header-section-number">4.6</span> Improve RDF Structure</h2>
<p>Overall, bSDD RDF represents the scope of bSDD data faithfully, although there are various omissions. We highlight the problems to be corrected.
Let's examine the RDF Turtle for <code>ClassificationProperty</code> "IfcCableSegmentCABLESEGMENT/ACResistance":</p>
<pre class="turtle"><code>&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT/ACResistance&gt;
  bsdd:ClassificationProperty &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT&gt;;
  bsdd:PropertyDomainName &quot;IFC&quot;;
  bsdd:PropertyNamespaceUri &quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/ACResistance&quot;.</code></pre>
<p>It has these defects:</p>
<ul>
<li>Lacks <code>rdf:type</code></li>
<li>RDF property names should start in lowercase</li>
<li>String attributes should be converted to relations whenever possiblek applicable</li>
<li>URLs should be object properties instead of strings</li>
</ul>
<p>This Turtle can be corrected as follows:</p>
<pre class="turtle"><code>&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT/ACResistance&gt;
  a bsdd:ClassificationProperty;
  bsdd:classification &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT&gt;;
  bsdd:domain &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3&gt;;
  bsdd:property &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/ACResistance&gt;.</code></pre>
<h2 data-number="4.7" id="graphql-improvements"><span class="header-section-number">4.7</span> GraphQL Improvements</h2>
<p>In this section we describe problems with the original bSDD GraphQL API.</p>
<h3 data-number="4.7.1" id="searchability-and-pagination"><span class="header-section-number">4.7.1</span> Searchability and Pagination</h3>
<p>The most important shortcomings of the original GraphQL API are:</p>
<ul>
<li>One can search only by very few parameters.
The user is limited to very basic fetching of data: all entities of a class, entity by <code>namespaceUri</code>, or basic full-text search (<code>classificationSearch</code>).
GraphQL users cannot search e.g. for:
<ul>
<li>Compound properties and their constituents</li>
<li>Dynamic properties (although currently none has constituents)</li>
<li>Classifications with relations, and their related classifications</li>
<li>Properties that are Writable or Required</li>
<li>Properties with relations, and their related properties</li>
</ul></li>
<li>No pagination.
One cannot get only a portion of the results, and iterate through pages with <code>limit/offset</code>.
Due to this limitation, one cannot get more than 5000 classifications per domain.</li>
</ul>
<p>These shortcomings are not present in our refactored GraphQL endpoint, whcih includes a comprehensive <code>where</code> query language.
You can see some sample queries towards the end.</p>
<h3 data-number="4.7.2" id="eliminate-parallel-links-between-entities"><span class="header-section-number">4.7.2</span> Eliminate Parallel Links Between Entities</h3>
<p>There are a number of parallel relations (arrows) in the original GraphQL schema.</p>
<ul>
<li><code>Root.{domain,domains}</code></li>
<li><code>Domain.{classification,classificationSearch}</code></li>
<li><code>Classification.{property,properties}</code></li>
<li><code>Property.{allowedValues,possibleValues}</code>: <code>possibleValues</code> is deprecated and should be removed</li>
<li><code>ClassificationProperty.{allowedValues,possibleValues}</code>: same</li>
</ul>
<p>This is not needed in GraphQL because the schema can use parameters to distinguish between different uses of the same field
(e.g. fetch one entity by URL vs search for entities).
It's best practice for the relation to be named the same as the target entity.
We have eliminated such parallel links from the refactored schema.</p>
<h3 data-number="4.7.3" id="graphql-arrays-and-nullability"><span class="header-section-number">4.7.3</span> GraphQL Arrays and Nullability</h3>
<p>A GraphQL schema can declare mandatory/optional status at the level of array and at the level of individual elements:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">type</th>
<th style="text-align: left;">meaning</th>
<th style="text-align: left;">valid examples</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><code>[Classification]</code></td>
<td style="text-align: left;">Optional array of optional elements</td>
<td style="text-align: left;"><code>null, [], [null], [Classification]</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>[Classification!]</code></td>
<td style="text-align: left;">Optional array of mandatory elements</td>
<td style="text-align: left;"><code>null, [], [Classification]</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;"><code>[Classification]!</code></td>
<td style="text-align: left;">Mandatory array of optional elements</td>
<td style="text-align: left;"><code>[], [null], [Classification]</code></td>
</tr>
<tr class="even">
<td style="text-align: left;"><code>[Classification!]!</code></td>
<td style="text-align: left;">Mandatory array of mandatory elements</td>
<td style="text-align: left;"><code>[], [Classification]</code></td>
</tr>
</tbody>
</table>
<p>(As you see, there is no way to enforce a <strong>non-empty</strong> array in GraphQL.)</p>
<p>bSDD specifies arrays as <code>[Classification]</code>, which is the most permissive specification.
It means that <code>[null, null, null]</code> is a valid result of a query that returns an array of Classifications.
However, such result is not suitable because null elements are useless.
It would be better to use the type <code>[Classification!]</code>.</p>
<h3 data-number="4.7.4" id="null-classifications-error"><span class="header-section-number">4.7.4</span> Null Classifications Error</h3>
<p>Although <code>classificationSearch</code> is declared as nullable (see previous section), a GraphQL error is returned whenever the backend returns <code>null</code>.
Querying all domains with all their classifications:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> getDomainsAndClassifications {</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  domains {</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>    namespaceUri</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    classificationSearch {</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>      namespaceUri</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Returns such an error:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;errors&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;Error trying to resolve field &#39;classificationSearch&#39;.&quot;</span><span class="fu">,</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;locations&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;line&quot;</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;column&quot;</span><span class="fu">:</span> <span class="dv">5</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;path&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;domains&quot;</span><span class="ot">,</span></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>        <span class="dv">67</span><span class="ot">,</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;classificationSearch&quot;</span></span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;extensions&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;NULL_REFERENCE&quot;</span><span class="fu">,</span></span>
<span id="cb55-18"><a href="#cb55-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;codes&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb55-19"><a href="#cb55-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;NULL_REFERENCE&quot;</span></span>
<span id="cb55-20"><a href="#cb55-20" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span></span>
<span id="cb55-21"><a href="#cb55-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb55-22"><a href="#cb55-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb55-23"><a href="#cb55-23" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb55-24"><a href="#cb55-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb55-25"><a href="#cb55-25" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;domains&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb55-26"><a href="#cb55-26" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb55-27"><a href="#cb55-27" aria-hidden="true" tabindex="-1"></a><span class="er">...</span></span></code></pre></div>
<h3 data-number="4.7.5" id="null-classification-childs-error"><span class="header-section-number">4.7.5</span> Null Classification Childs Error</h3>
<p><code>Classification.childs</code> is defined as nullable: with type <code>[Classification]</code>
However, unless <code>includeChilds: true</code> is provided as input argument in <code>classification</code>,
queries return NULL_REFERENCE errors, thus breaking GraphQL spec compliance. E.g. this query:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> getClassificationChildren {</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  classification(namespaceUri: <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox&quot;</span>,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                 includeChilds: <span class="cn">false</span>) {</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>    namespaceUri</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>    childs {</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>      namespaceUri</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Returns this error:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;errors&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;Error trying to resolve field &#39;childs&#39;.&quot;</span><span class="fu">,</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;locations&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;line&quot;</span><span class="fu">:</span> <span class="dv">4</span><span class="fu">,</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;column&quot;</span><span class="fu">:</span> <span class="dv">5</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;path&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;classification&quot;</span><span class="ot">,</span></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;childs&quot;</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;extensions&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;NULL_REFERENCE&quot;</span><span class="fu">,</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;codes&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;NULL_REFERENCE&quot;</span></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span></span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;classification&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcAirTerminalBox&quot;</span><span class="fu">,</span></span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;childs&quot;</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 data-number="4.7.6" id="null-classificationproperty-name-error"><span class="header-section-number">4.7.6</span> Null ClassificationProperty Name Error</h3>
<p>Some ClassificationProperties have no <code>name</code>.
Although that field is declared nullable, bSDD does not return such properties and instead returns <code>NULL_REFERENCE</code> errors.
For example:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> getClassificationProperties {</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  classification(namespaceUri: <span class="st">&quot;https://identifier.buildingsmart.org/uri/molio/cciconstruction-1.0/class/L-NAA&quot;</span>) {</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    name</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    properties {</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>      name</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This query returns four out of five properties: the 4th property is returned as <code>null</code>, along with an error:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;errors&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;Error trying to resolve field &#39;name&#39;.&quot;</span><span class="fu">,</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;locations&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;line&quot;</span><span class="fu">:</span> <span class="dv">5</span><span class="fu">,</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;column&quot;</span><span class="fu">:</span> <span class="dv">7</span></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;path&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;classification&quot;</span><span class="ot">,</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;properties&quot;</span><span class="ot">,</span></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a>        <span class="dv">3</span><span class="ot">,</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&quot;name&quot;</span></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;extensions&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;NULL_REFERENCE&quot;</span><span class="fu">,</span></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;codes&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;NULL_REFERENCE&quot;</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb59-26"><a href="#cb59-26" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;classification&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb59-27"><a href="#cb59-27" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Pane&quot;</span><span class="fu">,</span></span>
<span id="cb59-28"><a href="#cb59-28" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb59-29"><a href="#cb59-29" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb59-30"><a href="#cb59-30" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;FireRating&quot;</span></span>
<span id="cb59-31"><a href="#cb59-31" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb59-32"><a href="#cb59-32" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb59-33"><a href="#cb59-33" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ThermalTransmittance&quot;</span></span>
<span id="cb59-34"><a href="#cb59-34" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb59-35"><a href="#cb59-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb59-36"><a href="#cb59-36" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;GlassLayers&quot;</span></span>
<span id="cb59-37"><a href="#cb59-37" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb59-38"><a href="#cb59-38" aria-hidden="true" tabindex="-1"></a>        <span class="kw">null</span><span class="ot">,</span></span>
<span id="cb59-39"><a href="#cb59-39" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb59-40"><a href="#cb59-40" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IsExternal&quot;</span></span>
<span id="cb59-41"><a href="#cb59-41" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb59-42"><a href="#cb59-42" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span></span>
<span id="cb59-43"><a href="#cb59-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb59-44"><a href="#cb59-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb59-45"><a href="#cb59-45" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 data-number="4.7.7" id="missing-domains"><span class="header-section-number">4.7.7</span> Missing Domains</h3>
<p>The GraphQL root field <code>domains</code> used to return some domains that are not available individually through the field <code>domain</code>, e.g.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  domains {</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>    id: namespaceUri</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>  domain(namespaceUri: <span class="st">&quot;http://identifier.buildingsmart.org/uri/spr/spr-cfhios-0.1&quot;</span>) {</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    id: namespaceUri</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>The second response for <code>domain</code> will be <code>null</code> although the domain is present in the <code>domains</code> response.
We saw this problem in January 2023, but it's not present in February 2023.
Note: <code>cfhios</code> above is misspelled, because the name of that data standard is "CFIHOS".</p>
<h3 data-number="4.7.8" id="unexpected-multiple-values"><span class="header-section-number">4.7.8</span> Unexpected Multiple Values</h3>
<p>The attribute <code>propertySet</code> is defined as single (SCALAR), see <code>bsdd-graphql-schema-orig.json</code>:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;name&quot;:</span> <span class="er">&quot;propertySet&quot;,</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;description&quot;:</span> <span class="er">&quot;Name</span> <span class="er">of</span> <span class="er">the</span> <span class="er">property</span> <span class="er">set&quot;,</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;args&quot;:</span> <span class="ot">[]</span><span class="er">,</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;type&quot;:</span> <span class="fu">{</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;kind&quot;</span><span class="fu">:</span> <span class="st">&quot;SCALAR&quot;</span><span class="fu">,</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;String&quot;</span><span class="fu">,</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;ofType&quot;</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span></code></pre></div>
<p>But in fact there are 1924 <code>ClassificationProperty</code> where this attribute is multi-valued:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
select * where {
  ?classProp bsdd:propertySet ?set1, ?set2
  filter(?set1&lt;?set2)
}</code></pre>
<p>For example:</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">classProp</th>
<th style="text-align: left;">set1</th>
<th style="text-align: left;">set2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/bca/ifc-sg-0.1/class/IndependentWorkersDormitory/NumberofWorkers" class="uri">https://identifier.buildingsmart.org/uri/bca/ifc-sg-0.1/class/IndependentWorkersDormitory/NumberofWorkers</a></td>
<td style="text-align: left;">SGPset_Building</td>
<td style="text-align: left;">SGPset_Site</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcElementAssemblySUSPENSIONASSEMBLY/ContactWireStagger" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcElementAssemblySUSPENSIONASSEMBLY/ContactWireStagger</a></td>
<td style="text-align: left;">Pset_ElementAssemblyTypeOCSSuspension</td>
<td style="text-align: left;">Pset_ElementAssemblyTypeSteadyDevice</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcElementAssemblySUSPENSIONASSEMBLY/ContactWireStagger" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcElementAssemblySUSPENSIONASSEMBLY/ContactWireStagger</a></td>
<td style="text-align: left;">Pset_ElementAssemblyTypeCantilever</td>
<td style="text-align: left;">Pset_ElementAssemblyTypeSteadyDevice</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcElementAssemblySUSPENSIONASSEMBLY/ContactWireStagger" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcElementAssemblySUSPENSIONASSEMBLY/ContactWireStagger</a></td>
<td style="text-align: left;">Pset_ElementAssemblyTypeCantilever</td>
<td style="text-align: left;">Pset_ElementAssemblyTypeOCSSuspension</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcRampFlight/PieceMark" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcRampFlight/PieceMark</a></td>
<td style="text-align: left;">Pset_PrecastConcreteElementFabrication</td>
<td style="text-align: left;">Pset_PrecastConcreteElementGeneral</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcRampFlight/TypeDesignation" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcRampFlight/TypeDesignation</a></td>
<td style="text-align: left;">Pset_PrecastConcreteElementFabrication</td>
<td style="text-align: left;">Pset_PrecastConcreteElementGeneral</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcPile/TypeDesignation" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcPile/TypeDesignation</a></td>
<td style="text-align: left;">Pset_PrecastConcreteElementFabrication</td>
<td style="text-align: left;">Pset_PrecastConcreteElementGeneral</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcPile/PieceMark" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcPile/PieceMark</a></td>
<td style="text-align: left;">Pset_PrecastConcreteElementFabrication</td>
<td style="text-align: left;">Pset_PrecastConcreteElementGeneral</td>
</tr>
<tr class="odd">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcColumn/TypeDesignation" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcColumn/TypeDesignation</a></td>
<td style="text-align: left;">Pset_PrecastConcreteElementFabrication</td>
<td style="text-align: left;">Pset_PrecastConcreteElementGeneral</td>
</tr>
<tr class="even">
<td style="text-align: left;"><a href="https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcColumn/Reference" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcColumn/Reference</a></td>
<td style="text-align: left;">Pset_ColumnCommon</td>
<td style="text-align: left;">Pset_ReinforcementBarPitchOfColumn</td>
</tr>
</tbody>
</table>
<p>The original bSDD GraphQL endpoint happily returns such mis-declared values. E.g. this query:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  domain(namespaceUri: <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3&quot;</span>) {</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>    classification(namespaceUri:<span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcElementAssemblySUSPENSIONASSEMBLY&quot;</span>) {</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>      name</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>      properties{</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>        name</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>        propertyValueKind</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>        propertySet</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Rteurns the offending property 3 times, without getting any warning:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ContactWireStagger&quot;</span><span class="fu">,</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_ElementAssemblyTypeCantilever&quot;</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;SystemHeight&quot;</span><span class="fu">,</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_ElementAssemblyTypeCantilever&quot;</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ContactWireHeight&quot;</span><span class="fu">,</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_ElementAssemblyTypeOCSSuspension&quot;</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ContactWireStagger&quot;</span><span class="fu">,</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_ElementAssemblyTypeOCSSuspension&quot;</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ContactWireStagger&quot;</span><span class="fu">,</span></span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_ElementAssemblyTypeSteadyDevice&quot;</span></span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span><span class="er">,</span></span></code></pre></div>
<p>This will be an unpleasant surprise for processing applications that expect to get each property once,
and you see that the 3 copies of "ContactWireStagger" are not even returned consecutively.</p>
<p>Let's try a similar query at our refactored GraphQL endpoint:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> DomainIFC_ClassWall_Props {</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  domain(<span class="dt">ID</span>:<span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3&quot;</span>) {</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    classification(<span class="dt">ID</span>:<span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcWall&quot;</span>) {</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>      name</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>      classificationProperty {</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>        name</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>        propertyValueKind</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>        propertySet</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>In contrast to the original, it returns error information for each offending occurrence (in addition to returning data):</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;errors&quot;:</span> <span class="ot">[</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;Found 2 values for single-valued field &#39;propertySet&#39; from &#39;ClassificationProperty&#39;&quot;</span><span class="fu">,</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;path&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;domain&quot;</span><span class="ot">,</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="ot">,</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;classification&quot;</span><span class="ot">,</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="ot">,</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;classificationProperty&quot;</span><span class="ot">,</span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>      <span class="dv">24</span><span class="ot">,</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;propertySet&quot;</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;locations&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;line&quot;</span><span class="fu">:</span> <span class="dv">8</span><span class="fu">,</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;column&quot;</span><span class="fu">:</span> <span class="dv">9</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span></code></pre></div>
<p>We could fix this error easily by declaring the property to be multi-valued,
but we think that <code>propertySet</code> should in fact be single-valued, so the data should be fixed.</p>
<h3 data-number="4.7.9" id="deprecated-properties"><span class="header-section-number">4.7.9</span> Deprecated Properties</h3>
<p>The field <code>possibleValues</code> is described as "deprecated".
However, the GraphQL spec section <a href="https://spec.graphql.org/draft/#sec-Field-Deprecation">Field Deprecation</a> shows that a specific <code>@deprecated</code> directive should be used for this purpose.
In the refactored RDF data and GraphQL schema, we removed this field since it just duplicates the function of <code>allowedValues</code>.</p>
<h2 data-number="4.8" id="data-quality-problems"><span class="header-section-number">4.8</span> Data Quality Problems</h2>
<p>We found many data quality problems in bSDD, as described below.</p>
<h3 data-number="4.8.1" id="trim-leading-trailing-consecutive-whitespace"><span class="header-section-number">4.8.1</span> Trim Leading, Trailing, Consecutive Whitespace</h3>
<p>Many bSDD fields are defined as <code>xsd:string</code>.
However, certain whitespaces in strings can be confusing and are not semantically meaningful
(i.e. two values differing only by such whitespace must not be considered to be different):</p>
<ul>
<li>Leading and Trailing whitespaces should not be present</li>
<li>Consecutive whitespaces should not be present</li>
<li>Tabs should not be used: use spaces instead</li>
<li>Newlines are permissible only in a few cases, but should not be used to describe enumerations</li>
</ul>
<p>The datatypes <code>xsd:TOKEN</code> and <code>xsd:NMTOKENS</code> have restrictions in this regard.</p>
<p>The following query finds some of these cases:</p>
<pre class="sparql"><code>select * {
  ?x ?field ?value
  filter(regex(str(?value),&quot;^[ \\n\\t]|[ \\n\\t]$&quot;))
}</code></pre>
<p>Examples where this happens (not a comprehensive list):</p>
<ul>
<li><code>bsdd:dataType</code> (eg "Real "): this is a crucially important key field that must be controlled.</li>
<li><code>bsdd:description</code> that is an enumeration. Should be expressed as <code>allowedValues</code>. e.g. in <a href="https://identifier.buildingsmart.org/uri/engisis/RFI-02/prop/S25750_0010" class="uri">https://identifier.buildingsmart.org/uri/engisis/RFI-02/prop/S25750_0010</a>:</li>
</ul>
<!-- -->
<pre><code>&quot;EL=Elettronica,
SE=Semi-elettronica,
EM=Elettromeccanica,
EMS=Elettromeccanica CPS,
STI= Sistema Telef. Integr.(STI).

EL=Centrale Telefonica Elettronica,
SE=Centrale Telefonica Semi-Elettronica
 EM= Centrale Telefonica Elettromeccanica,
EMS= Centrale Telefonica Elettromeccanica CPS,
STI=  Centrale STI (Sistema Telefonico Integrato)
&quot;</code></pre>
<p>The bSDD data entry or data ingest systems should have validations to prevent such whitespace.
e.g. we could define SHACL rules to prevent such cases.</p>
<h3 data-number="4.8.2" id="improve-physical-quantities-and-units"><span class="header-section-number">4.8.2</span> Improve Physical Quantities and Units</h3>
<p>Properties have three characteristics that should be closely correlated:</p>
<ul>
<li><code>dimension</code>: dimension vector as 7 integers in the format:
L=Length M=Mass T=Time I=Electric current Θ=Thermodynamic temperature N=Amount of substance J=Luminous intensity.
E.g. <code>"1 1 -2 0 0 0 0"</code> represents <code>Force=Length*Mass/Time^2</code></li>
<li><code>unit</code>: unit of measure, which should be compatible with the dimension.
E.g. "m, cm, mm, in" are all compatible with Length (<code>"1 0 0 0 0 0 0"</code>)
<ul>
<li>Unfortunately, the units are not spelled consistently and are incompatible with the type <code>Unit</code>.
There is some effort to incorporate (or migrate towards) the QUDT ontology:
some properties have attribute <code>qudtUnit</code> in the JSON API.</li>
<li>But this is not the right approach: <code>qudtUnit</code> should be attached to <code>Unit</code>, or should replace <code>Property.unit</code></li>
<li>Also, this migration is not yet implemented</li>
</ul></li>
<li><code>physicalQuantity</code>: physical quantity being measured, should be compatible with the dimension.
E.g. "Height, Width, Diameter" are all compatible with Length.</li>
</ul>
<p>The following query finds all combinations of the three characteristics:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
select ?dim ?unit ?quant (count(*) as ?props) {
  ?x bsdd:unit ?unit; bsdd:physicalQuantity ?quant; bsdd:dimension ?dim
} group by ?dim ?unit ?quant  order by ?dim</code></pre>
<p>There are 60 combinations, too many to present here. A lot of them are due to different spelling of <code>physicalQuantity</code>, which is free text, e.g.:</p>
<ul>
<li>"Longueur" vs "Länge | de-DE";</li>
<li>"Force" vs "Kraft | de-DE";</li>
<li>"Epaisseur" vs "Thickness"</li>
</ul>
<p>This approach is wrong, because e.g. one cannot find all Thickness properties easily.
QUDT provides URLs for various measurable quantities, and labels in numerous languages.</p>
<p>Let's ignore <code>physicalQuantity</code>, but allow some of <code>dimension, unit</code> to be missing:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
select ?dim ?unit (count(*) as ?props) {
  {?x a bsdd:Property} union {?x a bsdd:ClassificationProperty}
  optional {?x bsdd:unit ?unit}
  optional {?x bsdd:dimension ?dim}
} group by ?dim ?unit order by ?dim</code></pre>
<p>There are 260 combinations, specifically:</p>
<ul>
<li>134698 properties have no <code>dimension</code>.
<ul>
<li>2434 properties have <code>dimension</code> "" (the empty string).</li>
</ul></li>
<li>107861 properties have no <code>unit</code>, which is acceptable for enumerated and Boolean properties, and may be used for some dimensionless properties.</li>
<li>104887 properties have neither <code>unit</code> nor <code>dimension</code>, which is acceptable for enumerated and Boolean properties only.</li>
<li>29811 properties have <code>unit</code> but no <code>dimension</code>. e.g.
<ul>
<li>38 properties with unit "m" have the correct dimension vector "1 0 0 0 0 0 0", but 1529 properties have no dimension.</li>
<li>579 properties with unit "mm" have the correct dimension vector "1 0 0 0 0 0 0", but 14983 properties have no dimension, and 4 have the wrong dimension "2 0 3 0 0 0 0".</li>
</ul></li>
</ul>
<p>Query for the last observation (about unit "mm"):</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
select ?dim (count(*) as ?props) {
  {?x a bsdd:Property} union {?x a bsdd:ClassificationProperty}
  ?x bsdd:unit &quot;mm&quot;
  optional {?x bsdd:dimension ?dim}
} group by ?dim order by ?dim</code></pre>
<p>We can find these defective properties as follows:</p>
<pre class="sparql"><code>PREFIX bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
PREFIX rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
select * {
  {?x a bsdd:Property} union {?x a bsdd:ClassificationProperty}
  ?x bsdd:unit &quot;mm&quot;; bsdd:dimension &quot;2 0 3 0 0 0 0&quot;; bsdd:name ?name; bsdd:code ?code
}</code></pre>
<p>They all represent the property EF007220 "Busbar thickness"</p>
<h3 data-number="4.8.3" id="rules-about-missing-data"><span class="header-section-number">4.8.3</span> Rules About Missing Data</h3>
<p>bSDD should define rules how to express missing data.
It is ok to have no <code>physicalQuantity</code> for dimensionless properties (e.g. count, percentage) or enumerated properties (having a list of <code>allowedValues</code>).
But such missing data is expressed as various free texts:</p>
<ul>
<li>Property "Caractérisation du sol" ("Soil characterization")
in class "Teneur en eau du sol" ("Soil water content")
has <code>physicalQuantity</code> "sans grandeur" ("without magnitude")
because it's a dimensionless quantity.</li>
<li>Property "Document de référence de mise en œuvre d'un revêtement de sol résilient" ("Reference document for the implementation of a resilient floor covering")
in class "Revêtement de sol résilient PVC à queues d'aronde et type puzzle" ("PVC resilient floor covering with dovetails of type puzzle")
has <code>physicalQuantity</code> "Without"
because it's an enumeration.</li>
<li>There are 4 properties with <code>physicalQuantity</code> "N/A" but <code>unit</code> "m": this makes no sense (the quantity should be "Length")</li>
</ul>
<p>It's better to omit <code>physicalQuantity</code> altogether, rather than use a variety of phrases to indicate NONE.</p>
<h3 data-number="4.8.4" id="unicode-problems"><span class="header-section-number">4.8.4</span> Unicode Problems</h3>
<p>There are Unicode problems in some <code>bsdd:description</code>.</p>
<p>E.g. in <a href="https://identifier.buildingsmart.org/uri/buildingsmart-de/bSDTLS-1/prop/02-02-01-010" class="uri">https://identifier.buildingsmart.org/uri/buildingsmart-de/bSDTLS-1/prop/02-02-01-010</a> :</p>
<pre><code>&quot;Zeit der m�glichen Verarbeitung vor Aush�rtung in [min] bei +23�C und 50% rel. Luftfeuchtigkeit
&quot;</code></pre>
<p>(also has a trailing newline)</p>
<h3 data-number="4.8.5" id="unresolved-html-entities"><span class="header-section-number">4.8.5</span> Unresolved HTML Entities</h3>
<p>There are unresolved HTML entities (encoded chars).</p>
<p>E.g. in <a href="https://identifier.buildingsmart.org/uri/engisis/RFI-02/prop/S27300_0200" class="uri">https://identifier.buildingsmart.org/uri/engisis/RFI-02/prop/S27300_0200</a>:</p>
<pre><code>&quot;(*)
Pu&amp;#242; essere valorizzato un solo valore. SCIA = valorizzabile per le attivit&amp;#224; di tipo A o per le attivit&amp;#224; di tipo B o C nel caso in cui a seguito della valutazione favorevole del progetto si sia presentata la SCIA (ma non sia stato ancora rilasciato copia del verbale della visita tecnica dei VVF -attivit&amp;#224; di tipo A o B- o il CPI -attivit&amp;#224; ...&quot;.</code></pre>
<h3 data-number="4.8.6" id="bad-classification-relations"><span class="header-section-number">4.8.6</span> Bad Classification Relations</h3>
<p>Some classifications relate to to a full classification URL, but to
<code>https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/</code>, which is incomplete.
For example, this query at the original GraphQL endpoint:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  domain(namespaceUri: <span class="st">&quot;https://identifier.buildingsmart.org/uri/BBRI/CCTB-2020&quot;</span>) {</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>    classification(namespaceUri: <span class="st">&quot;https://identifier.buildingsmart.org/uri/BBRI/CCTB-2020/class/42.15&quot;</span>) {</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>      relations {</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>        relatedClassificationName</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        relatedClassificationUri</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Returns the following:</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;domain&quot;:</span> <span class="fu">{</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;classification&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;relations&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;relatedClassificationName&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;relatedClassificationUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/&quot;</span></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h1 data-number="5" id="implementing-improvements"><span class="header-section-number">5</span> Implementing Improvements</h1>
<p>We implemented a lot (but not all) of the improvements suggested above by using the following process:</p>
<ul>
<li>Fetching bSDD data as JSON</li>
<li>Converting it to RDF using <a href="https://sparql-anything.cc/">SPARQL Anything</a></li>
<li>Loading it to <a href="https://www.ontotext.com/products/graphdb/">GraphDB</a></li>
<li>Refactoring the RDF using SPARQL Update</li>
</ul>
<h2 data-number="5.1" id="converting-json-to-raw-rdf-using-sparql-anything"><span class="header-section-number">5.1</span> Converting JSON to Raw RDF using SPARQL Anything</h2>
<p>In the next step we convert the JSON files to RDF.
We used the <a href="https://sparql-anything.cc/">SPARQL Anything</a> tool (see <a href="https://sparql-anything.readthedocs.io/">documentation</a>) that can convert various data formats to RDF by using SPARQL queries.</p>
<p>We developed two scripts:</p>
<ul>
<li><a href="./scripts/rdfize.sparql">rdfize.sparql</a> rdfizes one file. Parameter:
<ul>
<li><code>-v file</code>: file (local) or URL</li>
</ul></li>
<li><a href="./scripts/rdfize-zip.sparql">rdfize-zip.sparql</a> rdfizes an archive (zip) of files. Parameters:
<ul>
<li><code>-v zip</code>: zip filename or URL</li>
<li><code>-v file</code>: file regexp pattern (default <code>.*</code>)</li>
</ul></li>
</ul>
<p>The scripts invoke like this:</p>
<pre class="example"><code>java -jar sparql-anything.jar -q rdfize.sparql    -v file=bSDD/ifc-4.3/IfcCableSegmentCABLESEGMENT.json
java -jar sparql-anything.jar -q rdfize-zip.sparql -v zip=bSDD/ifc-4.3.zip -v file=IfcCableSegmentCABLESEGMENT.json</code></pre>
<p>We explain the more complex script (<code>rdfize-zip.sparql</code>) below:</p>
<pre class="sparql"><code>prefix bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;
prefix xyz:  &lt;http://sparql.xyz/facade-x/data/&gt;
prefix fx:   &lt;http://sparql.xyz/facade-x/ns/&gt;
prefix rdf:  &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;
prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;
prefix xsd:  &lt;http://www.w3.org/2001/XMLSchema#&gt;

construct {
  ?s ?p ?o
} where {
  service &lt;x-sparql-anything:&gt; {
    bind(coalesce(?__file,&quot;.*&quot;) as ?pattern)
    fx:properties fx:location ?_zip.
    fx:properties fx:archive.matches ?pattern.
    [] fx:anySlot ?file
    service &lt;x-sparql-anything:media-type=application/json&gt; {
      bind(str(bsdd:) as ?bsdd)
      fx:properties fx:namespace ?bsdd.
      fx:properties fx:location ?file.
      fx:properties fx:from-archive ?_zip.
      fx:properties fx:use-rdfs-member true.
      ?s ?p ?o
    }
  }
}</code></pre>
<p>We use the simplest case of SPARQL Anything to convert JSON to RDF:</p>
<pre class="example"><code>construct {?s ?p ?o} where {?s ?p ?o}</code></pre>
<ul>
<li>The Raw RDF has a similar form to the JSON, see next section</li>
<li>It is possible to write more complex queries to drill down into the RDF structure, but we preferred to refactor RDF using SPARQL Update, see the section after next</li>
<li>SPARQL Anything uses the prefix <code>fx:</code> for its features and functions.</li>
<li>We define the <code>bsdd:</code> ontology namespace the same as the existing bSDD RDF data.</li>
<li>SPARQL Anything uses the prefix <code>xyz:</code> to emit the output data.
However, we use <code>fx:properties fx:namespace</code> to cast the data to the <code>bsdd:</code> namespace, so we don't use the <code>xyz:</code> prefix.
The argument of this parameter is a string, so we use <code>bind(str(bsdd:) as ?bsdd)</code> to convert the respective namespace URL to a string</li>
<li>We use the option <code>fx:properties fx:use-rdfs-member true</code> to emit JSON array members as multiple values of <code>rdfs:member</code> rather than the predicates <code>rdf:_1, rdf:_2 ...</code></li>
</ul>
<p>All other lines of the script take care of handling input.</p>
<ul>
<li>We use command-line parameters to pass (<a href="https://sparql-anything.readthedocs.io/en/latest/#query-templates-and-variable-bindings-cli-only">variable bindings to the SPARQL Anything CLI)</a>.
It uses the <a href="https://github.com/basilapi/basil/wiki/SPARQL-variable-name-convention-for-WEB-API-parameters-mapping">BASIL convention for variable names in queries</a>:
<code>?_zip</code> is a mandatory param, and <code>?__file</code> is an optional param</li>
<li>The outer <code>service</code> invocation opens the zip archive:
<ul>
<li>Provides a default value for <code>?__file</code> by using <code>coalesce</code></li>
<li>Opens the <code>?_zip</code> archive using <code>fx:location</code></li>
<li>Uses <code>fx:archive.matches</code> to find all filenames that match <code>?pattern</code></li>
<li>The result is a list that we parse out by using <code>fx:anySlot</code> and feed it as multiple bindings to the variable <code>?file</code></li>
</ul></li>
<li>The inner <code>service</code> invocation opens the respective files from the zip archive:
<ul>
<li>Now we set <code>fx:location</code> to the filename found in the archive</li>
<li>And we use <a href="https://sparql-anything.readthedocs.io/en/latest/Configuration/#from-archive">fx:from-archive</a> to open the archive again, and to read the file</li>
</ul></li>
</ul>
<h3 data-number="5.1.1" id="raw-json-example"><span class="header-section-number">5.1.1</span> Raw JSON Example</h3>
<p>An example classification in JSON obtained with the following command:</p>
<div class="sourceCode" id="cb80" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="ex">curl</span> <span class="at">-s</span> https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment <span class="kw">|</span> <span class="ex">jq</span> . <span class="op">&gt;</span> class-IfcCableSegment-orig1.json</span></code></pre></div>
<p>Shortened for brevity:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;referenceCode&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;parentClassificationReference&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcFlowSegment&quot;</span><span class="fu">,</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcFlowSegment&quot;</span><span class="fu">,</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcFlowSegment&quot;</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;classificationProperties&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;InstallationMethodFlagEnum&quot;</span><span class="fu">,</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Special installation conditions relating to particular types of installation based on IEC60364-5-52:2001 reference installation methods C and D.&quot;</span><span class="fu">,</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dataType&quot;</span><span class="fu">:</span> <span class="st">&quot;String&quot;</span><span class="fu">,</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;possibleValues&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;BELOWCEILING&quot;</span><span class="fu">,</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;BELOWCEILING&quot;</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyCode&quot;</span><span class="fu">:</span> <span class="st">&quot;InstallationMethodFlagEnum&quot;</span><span class="fu">,</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyDomainName&quot;</span><span class="fu">:</span> <span class="st">&quot;IFC&quot;</span><span class="fu">,</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyNamespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/InstallationMethodFlagEnum&quot;</span><span class="fu">,</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_CableSegmentOccurrence&quot;</span><span class="fu">,</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyStatus&quot;</span><span class="fu">:</span> <span class="st">&quot;Active&quot;</span><span class="fu">,</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;Single&quot;</span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;domainNamespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3&quot;</span><span class="fu">,</span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;activationDateUtc&quot;</span><span class="fu">:</span> <span class="st">&quot;2022-12-31T00:00:00&quot;</span><span class="fu">,</span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;countriesOfUse&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;definition&quot;</span><span class="fu">:</span> <span class="st">&quot;A cable segment is a flow segment used to carry electrical power, data, or telecommunications signals...&quot;</span><span class="fu">,</span></span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;replacedObjectCodes&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;replacingObjectCodes&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;Preview&quot;</span><span class="fu">,</span></span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;subdivisionsOfUse&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;versionDateUtc&quot;</span><span class="fu">:</span> <span class="st">&quot;2022-12-31T00:00:00&quot;</span></span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>The JSON representation obtained from the GraphQL API is very similar but not identical:</p>
<ul>
<li>We include <code>__typename</code> for each node to help assigning <code>rdf:type</code> later</li>
<li>All fields are present, even when they are <code>null</code></li>
<li>GraphQL fields are sometimes named differently (e.g. <code>properties</code> instead of <code>classificationProperties</code>)</li>
<li>There are some other differences, e.g. see <code>class-IfcCableSegment-orig.json</code> (shortened for brevity):</li>
</ul>
<div class="sourceCode" id="cb82"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;__typename&quot;</span><span class="fu">:</span> <span class="st">&quot;Classification&quot;</span><span class="fu">,</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;classificationType&quot;</span><span class="fu">:</span> <span class="st">&quot;CLASS&quot;</span><span class="fu">,</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;relatedIfcEntityNames&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;synonyms&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;referenceCode&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;properties&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/InstallationMethodFlagEnum&quot;</span><span class="fu">,</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;__typename&quot;</span><span class="fu">:</span> <span class="st">&quot;ClassificationProperty&quot;</span><span class="fu">,</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;allowedValues&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;namespaceUri&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;__typename&quot;</span><span class="fu">:</span> <span class="st">&quot;ClassificationPropertyValue&quot;</span><span class="fu">,</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;BELOWCEILING&quot;</span><span class="fu">,</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;value&quot;</span><span class="fu">:</span> <span class="st">&quot;BELOWCEILING&quot;</span><span class="fu">,</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;sortNumber&quot;</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>        <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>      <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dataType&quot;</span><span class="fu">:</span> <span class="st">&quot;String&quot;</span><span class="fu">,</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Special installation conditions relating to particular types of installation based on IEC60364-5-52:2001 reference installation methods C and D.&quot;</span><span class="fu">,</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimension&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimensionLength&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimensionMass&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimensionTime&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimensionElectricCurrent&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimensionThermodynamicTemperature&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimensionAmountOfSubstance&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dimensionLuminousIntensity&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;dynamicParameterPropertyCodes&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;example&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;isDynamic&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;isRequired&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;isWritable&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;maxExclusive&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;maxInclusive&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;methodOfMeasurement&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;minExclusive&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;minInclusive&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;pattern&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;physicalQuantity&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;predefinedValue&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_CableSegmentOccurrence&quot;</span><span class="fu">,</span></span>
<span id="cb82-46"><a href="#cb82-46" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb82-47"><a href="#cb82-47" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;symbol&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-48"><a href="#cb82-48" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;units&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-49"><a href="#cb82-49" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;activationDateUtc&quot;</span><span class="fu">:</span> <span class="st">&quot;2022-12-31T00:00:00&quot;</span><span class="fu">,</span></span>
<span id="cb82-50"><a href="#cb82-50" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;InstallationMethodFlagEnum&quot;</span><span class="fu">,</span></span>
<span id="cb82-51"><a href="#cb82-51" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;creatorLanguageCode&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-52"><a href="#cb82-52" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;countriesOfUse&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-53"><a href="#cb82-53" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;countryOfOrigin&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-54"><a href="#cb82-54" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;deActivationDateUtc&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-55"><a href="#cb82-55" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;definition&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-56"><a href="#cb82-56" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;deprecationExplanation&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-57"><a href="#cb82-57" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;documentReference&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-58"><a href="#cb82-58" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;InstallationMethodFlagEnum&quot;</span><span class="fu">,</span></span>
<span id="cb82-59"><a href="#cb82-59" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;replacedObjectCodes&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-60"><a href="#cb82-60" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;replacingObjectCodes&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-61"><a href="#cb82-61" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;revisionDateUtc&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-62"><a href="#cb82-62" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;revisionNumber&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-63"><a href="#cb82-63" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;Active&quot;</span><span class="fu">,</span></span>
<span id="cb82-64"><a href="#cb82-64" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;subdivisionsOfUse&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-65"><a href="#cb82-65" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;uid&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-66"><a href="#cb82-66" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;versionDateUtc&quot;</span><span class="fu">:</span> <span class="st">&quot;2022-12-31T00:00:00&quot;</span><span class="fu">,</span></span>
<span id="cb82-67"><a href="#cb82-67" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;versionNumber&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-68"><a href="#cb82-68" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;visualRepresentationUri&quot;</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb82-69"><a href="#cb82-69" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb82-70"><a href="#cb82-70" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb82-71"><a href="#cb82-71" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;relations&quot;</span><span class="fu">:</span> <span class="ot">[]</span><span class="fu">,</span></span>
<span id="cb82-72"><a href="#cb82-72" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;childs&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-73"><a href="#cb82-73" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;activationDateUtc&quot;</span><span class="fu">:</span> <span class="st">&quot;2022-12-31T00:00:00&quot;</span><span class="fu">,</span></span>
<span id="cb82-74"><a href="#cb82-74" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb82-75"><a href="#cb82-75" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;creatorLanguageCode&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-76"><a href="#cb82-76" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;countriesOfUse&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-77"><a href="#cb82-77" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;countryOfOrigin&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-78"><a href="#cb82-78" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;deActivationDateUtc&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-79"><a href="#cb82-79" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;definition&quot;</span><span class="fu">:</span> <span class="st">&quot;A cable segment is a flow segment used to carry electrical power, data, or telecommunications signals...&quot;</span><span class="fu">,</span></span>
<span id="cb82-80"><a href="#cb82-80" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;deprecationExplanation&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-81"><a href="#cb82-81" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;documentReference&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-82"><a href="#cb82-82" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCableSegment&quot;</span><span class="fu">,</span></span>
<span id="cb82-83"><a href="#cb82-83" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;replacedObjectCodes&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-84"><a href="#cb82-84" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;replacingObjectCodes&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-85"><a href="#cb82-85" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;revisionDateUtc&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-86"><a href="#cb82-86" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;revisionNumber&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-87"><a href="#cb82-87" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;status&quot;</span><span class="fu">:</span> <span class="st">&quot;Preview&quot;</span><span class="fu">,</span></span>
<span id="cb82-88"><a href="#cb82-88" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;subdivisionsOfUse&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-89"><a href="#cb82-89" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;uid&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-90"><a href="#cb82-90" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;versionDateUtc&quot;</span><span class="fu">:</span> <span class="st">&quot;2022-12-31T00:00:00&quot;</span><span class="fu">,</span></span>
<span id="cb82-91"><a href="#cb82-91" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;versionNumber&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb82-92"><a href="#cb82-92" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;visualRepresentationUri&quot;</span><span class="fu">:</span> <span class="kw">null</span></span>
<span id="cb82-93"><a href="#cb82-93" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h3 data-number="5.1.2" id="raw-rdf-example"><span class="header-section-number">5.1.2</span> Raw RDF Example</h3>
<p>The example GraphQL JSON is converted to the following "raw" RDF (shortened for brevity).
Its structure is very similar to the original one, with empty blank nodes in various places, strings instead of URLs, etc.</p>
<pre class="turtle"><code>@prefix bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt; .
@prefix fx:   &lt;http://sparql.xyz/facade-x/ns/&gt; .
@prefix rdf:  &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .
@prefix xsd:  &lt;http://www.w3.org/2001/XMLSchema#&gt; .
@prefix xyz:  &lt;http://sparql.xyz/facade-x/data/&gt; .

[ rdf:type                    fx:root ;
  bsdd:__typename             &quot;Classification&quot; ;
  bsdd:activationDateUtc      &quot;2022-12-31T00:00:00&quot; ;
  bsdd:classificationType     &quot;CLASS&quot; ;
  bsdd:code                   &quot;IfcCableSegment&quot; ;
  bsdd:definition             &quot;A cable segment is a flow segment used to carry electrical power, data, or telecommunications signals...&quot; ;
  bsdd:name                   &quot;IfcCableSegment&quot; ;
  bsdd:namespaceUri           &quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&quot; ;
  bsdd:properties [
    rdfs:member  [
    bsdd:__typename         &quot;ClassificationProperty&quot; ;
    bsdd:activationDateUtc  &quot;2022-12-31T00:00:00&quot; ;
    bsdd:allowedValues [
      rdfs:member  [
      bsdd:__typename  &quot;ClassificationPropertyValue&quot; ;
      bsdd:code        &quot;BELOWCEILING&quot; ;
      bsdd:value       &quot;BELOWCEILING&quot;
    ]] ;
    bsdd:code               &quot;InstallationMethodFlagEnum&quot; ;
    bsdd:dataType           &quot;String&quot; ;
    bsdd:description        &quot;Special installation conditions relating to particular types of installation based on IEC60364-5-52:2001 reference installation methods C and D.&quot; ;
    bsdd:isDynamic          false ;
    bsdd:name               &quot;InstallationMethodFlagEnum&quot; ;
    bsdd:namespaceUri       &quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/InstallationMethodFlagEnum&quot; ;
    bsdd:propertySet        &quot;Pset_CableSegmentOccurrence&quot; ;
    bsdd:propertyValueKind  &quot;SINGLE&quot; ;
    bsdd:status             &quot;Active&quot; ;
    bsdd:versionDateUtc     &quot;2022-12-31T00:00:00&quot;
  ]] ;
  bsdd:referenceCode          &quot;IfcCableSegment&quot; ;
  bsdd:relatedIfcEntityNames  []  ;
  bsdd:relations              []  ;
  bsdd:status                 &quot;Preview&quot; ;
  bsdd:synonyms               []  ;
  bsdd:versionDateUtc         &quot;2022-12-31T00:00:00&quot;
] .</code></pre>
<h2 data-number="5.2" id="refactoring-rdf-using-sparql-update"><span class="header-section-number">5.2</span> Refactoring RDF using SPARQL Update</h2>
<p>There are various things to fix in the Raw RDF.
We wrote the SPARQL Update script <a href="./scripts/transform.ru">transform.ru</a> (<code>.ru</code> is teh W3C standard extension for this type of file).
It does the following:</p>
<ul>
<li>Cut out fractional seconds from date-times, and add datatype <code>xsd:dateTime</code>
<ul>
<li>This pertains to <code>activationDateUtc deActivationDateUtc lastUpdatedUtc revisionDateUtc versionDateUtc</code></li>
<li><code>lastUpdatedUtc</code> has overly-specific timestamps to the precision of 10e-7 seconds, eg <code>2022-12-21T08:24:16.8080608</code>.
We cut out the fractional seconds because the GraphQL scalar type <code>DateTime</code> as currently implemented in the Ontotext Platform doesn't support such precision (nor do we see any business need for it in bSDD),</li>
<li>However, XSD allows any number of digits in the <a href="https://www.w3.org/TR/xmlschema11-2/#nt-seFrag">decimal part of seconds</a>, so we have posted an enhancement request <a href="https://ontotext.atlassian.net/browse/PLATFORM-4728">(PLATFORM-4728)</a> to allow this.</li>
</ul></li>
<li>Convert strings to URIs, and shorten props as appropriate
<ul>
<li>This pertains to all props called <code>*Uri</code>, and the following are shortened:</li>
</ul></li>
</ul>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">full</th>
<th style="text-align: left;">short</th>
<th style="text-align: left;">comment</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">bsdd:domainNamespaceUri</td>
<td style="text-align: left;">bsdd:domain</td>
<td style="text-align: left;">We point to the <code>Domain</code> not to its URI</td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:relatedClassificationUri</td>
<td style="text-align: left;">bsdd:related</td>
<td style="text-align: left;">We use the pair <code>relation/related</code> for both <code>PropertyRelation, ClassificationRelation</code></td>
</tr>
<tr class="odd">
<td style="text-align: left;">bsdd:relatedPropertyUri</td>
<td style="text-align: left;">bsdd:related</td>
<td style="text-align: left;">We use the pair <code>relation/related</code> for both <code>PropertyRelation, ClassificationRelation</code></td>
</tr>
<tr class="even">
<td style="text-align: left;">bsdd:parentClassificationReference</td>
<td style="text-align: left;">bsdd:parentClassification</td>
<td style="text-align: left;">We point to the parent <code>Classification</code>, so "reference" is parasitic</td>
</tr>
</tbody>
</table>
<ul>
<li>Drop redundant information of a referenced resource
<ul>
<li>e.g. inside <code>parentClassificationReference</code>, the properties <code>code, name</code> are dropped because they are defined in the master record of that classification, thus are redundant in the reference;</li>
</ul></li>
<li>Drop deprecated property <code>bsdd:possibleValues</code>, since <code>bsdd:allowedValue</code> is used instead;</li>
<li>Multi-valued properties: skip a level (<code>rdfs:member</code>) and change property name to singular:
<ul>
<li><code>bsdd:objects [rdfs:member [...], [...]]</code> becomes <code>bsdd:object [...], [...]</code>;</li>
<li>Empty lists like <code>bsdd:replacedObjectCodes []</code> above disappear altogether since that blank node representing the empty list is useless;</li>
</ul></li>
<li>Short-cut the property path <code>bsdd:parentClassificationReference/bsdd:namespaceUri</code> to just <code>bsdd:parentClassification</code>;</li>
<li>Add <code>rdf:type</code> based on GraphQL <code>__typename</code>;
<ul>
<li>e.g. <code>"__typename": "Domain"</code> becomes <code>rdf:type bsdd:Domain</code>;</li>
<li>However, <code>"__typename": "ClassificationPropertyValue"</code> becomes <code>rdf:type bsdd:PropertyValue</code>;
because the GraphQL class <code>ClassificationPropertyValue</code> is exactly the same as <code>PropertyValue</code>;</li>
</ul></li>
<li>Drop parasitic <code>rdf:type fx:root</code>;</li>
<li>Rename <code>ClassificationProperty.namespaceUri</code> to <code>ClassificationProperty.property</code> because that link refers to a <code>Property</code> specifically;</li>
<li>Add meaningful URIs to blank nodes whenever possible. In particular:
<ul>
<li><code>ClassificationProperty</code> gets URI: <code>Classification.uri+"/"+propertyCode</code> (here <code>+</code> indicates concatenation);</li>
<li><code>ClassificationPropertyValue</code> gets URI: <code>Classification.uri+"/"+ClassificationProperty.propertyCode +"/"+value</code>.
This class has <code>namespaceUri</code>, but that is optional and is rarely filled;</li>
<li><code>PropertyValue</code> gets URI: <code>Classification.uri+"/"+Property.propertyCode +"/"+value</code>.
This class has <code>namespaceUri</code>, but that is optional and is rarely filled.</li>
</ul></li>
<li>The following remain blank nodes:
<ul>
<li><code>ReferenceDocument</code>: no id field (only <code>name, title, date</code>);</li>
<li><code>ClassificationRelation</code>: is just a pair of <code>related</code> Properties, no own URI;</li>
<li><code>PropertyRelation</code>: is just a pair of <code>related</code> Properties, no own URI;</li>
</ul></li>
<li>Remove redundant <code>namespaceUri</code> when equal to the node's URI.</li>
</ul>
<p>This SPARQL Update script is class-independent (works on any Raw bSDD RDF), so it can be used in two ways:</p>
<ul>
<li>On an individual RDF file by using Jena's <code>update</code>, for testing</li>
<li>After loading all data to <a href="https://www.ontotext.com/products/graphdb/">GraphDB</a>, to transform all of it in one go</li>
</ul>
<h3 data-number="5.2.1" id="original-rdf-example"><span class="header-section-number">5.2.1</span> Original RDF Example</h3>
<p>Now let's take a look at the original bSDD RDF <code>class-IfcCableSegment-orig.ttl</code> obtained with the following (shortened for brevity):</p>
<pre class="example"><code>curl -s -Haccept:text/turtle https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment &gt; class-IfcCableSegment-orig.ttl</code></pre>
<pre class="turtle"><code>@base &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&gt;.

@prefix rdf: &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt;.
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt;.
@prefix xsd: &lt;http://www.w3.org/2001/XMLSchema#&gt;.
@prefix bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt;.
@prefix qudtUnit: &lt;http://qudt.org/vocab/unit/&gt;.
@prefix ifc4_3: &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3&gt;.

&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&gt;
  bsdd:ActivationDateUtc &quot;2022-12-31&quot;;
  bsdd:Code &quot;IfcCableSegment&quot;;
  bsdd:Definition &quot;A cable segment is a flow segment used to carry electrical power, data, or telecommunications signals...&quot;;
  bsdd:Domain ifc4_3:;
  bsdd:Name &quot;IfcCableSegment&quot;;
  bsdd:ReferenceCode &quot;IfcCableSegment&quot;;
  bsdd:Status &quot;Preview&quot;;
  bsdd:VersionDateUtc &quot;2022-12-31&quot;;
  a bsdd:Classification.

&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment/InstallationMethodFlagEnum&gt;
  bsdd:ClassificationProperty &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&gt;;
  bsdd:DataType &quot;String&quot;;
  bsdd:Description &quot;Special installation conditions relating to particular types of installation based on IEC60364-5-52:2001 reference installation methods C and D.&quot;;
  bsdd:Name &quot;InstallationMethodFlagEnum&quot;;
  bsdd:PropertyCode &quot;InstallationMethodFlagEnum&quot;;
  bsdd:PropertyDomainName &quot;IFC&quot;;
  bsdd:PropertyNamespaceUri &quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/InstallationMethodFlagEnum&quot;;
  bsdd:PropertySet &quot;Pset_CableSegmentOccurrence&quot;;
  bsdd:PropertyStatus &quot;Active&quot;;
  bsdd:PropertyValueKind &quot;Single&quot;.</code></pre>
<p>It has numerous problems:</p>
<ul>
<li>RDF naming conventions are not followed (prop names are in uppercase)</li>
<li>Classification Properties don't have <code>rdf:type bsdd:ClassificationProperty</code></li>
<li>The relation from Classification Property to Classification is in the wrong direction
(or should be renamed from <code>bsdd:ClassificationProperty</code> to <code>bsdd:classification</code>)</li>
<li><code>bsdd:PropertyNamespaceUri</code> should be a URL (object property) instead of string (datatype property)
and should be called <code>bsdd:property</code></li>
<li>Dates (eg <code>"2022-12-31"</code>) are rendered differently from JSON (have no timestamp), and lack appropriate datatype</li>
<li><code>allowedValues</code> and the respective <code>ClassificationPropertyValue</code> are missing altogether</li>
</ul>
<h3 data-number="5.2.2" id="refactored-rdf-example"><span class="header-section-number">5.2.2</span> Refactored RDF Example</h3>
<p>After applying the refactoring transformation, we get the following refactored RDF <code>class-IfcCableSegment-refact.ttl</code> (shortened for brevity).
Compare it to both the original RDF (sec <span class="spurious-link" target="*Original RDF Example"><em>*Original RDF Example</em></span>) and the raw RDF (sec <span class="spurious-link" target="*Raw RDF Example"><em>*Raw RDF Example</em></span>):</p>
<pre class="turtle"><code>@prefix bsdd: &lt;http://bsdd.buildingsmart.org/def#&gt; .
@prefix fx:   &lt;http://sparql.xyz/facade-x/ns/&gt; .
@prefix rdf:  &lt;http://www.w3.org/1999/02/22-rdf-syntax-ns#&gt; .
@prefix rdfs: &lt;http://www.w3.org/2000/01/rdf-schema#&gt; .
@prefix xsd:  &lt;http://www.w3.org/2001/XMLSchema#&gt; .
@prefix xyz:  &lt;http://sparql.xyz/facade-x/data/&gt; .

&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment&gt;
  rdf:type                     bsdd:Classification ;
  bsdd:activationDateUtc       &quot;2022-12-31T00:00:00&quot;^^xsd:dateTime ;
  bsdd:classificationProperty  &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment/InstallationMethodFlagEnum&gt;, ... ;
  bsdd:classificationType      &quot;CLASS&quot; ;
  bsdd:code                    &quot;IfcCableSegment&quot; ;
  bsdd:definition              &quot;A cable segment is a flow segment used to carry electrical power, data, or telecommunications signals...&quot; ;
  bsdd:name                    &quot;IfcCableSegment&quot; ;
  bsdd:referenceCode           &quot;IfcCableSegment&quot; ;
  bsdd:status                  &quot;Preview&quot; ;
  bsdd:versionDateUtc          &quot;2022-12-31T00:00:00&quot;^^xsd:dateTime .

&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment/InstallationMethodFlagEnum&gt;
  rdf:type                bsdd:ClassificationProperty ;
  bsdd:activationDateUtc  &quot;2022-12-31T00:00:00&quot;^^xsd:dateTime ;
  bsdd:allowedValue       &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment/InstallationMethodFlagEnum/BELOWCEILING&gt; , ... ;
  bsdd:code               &quot;InstallationMethodFlagEnum&quot; ;
  bsdd:dataType           &quot;String&quot; ;
  bsdd:description        &quot;Special installation conditions relating to particular types of installation based on IEC60364-5-52:2001 reference installation methods C and D.&quot; ;
  bsdd:isDynamic          false ;
  bsdd:name               &quot;InstallationMethodFlagEnum&quot; ;
  bsdd:property           &lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/prop/InstallationMethodFlagEnum&gt; ;
  bsdd:propertySet        &quot;Pset_CableSegmentOccurrence&quot; ;
  bsdd:propertyValueKind  &quot;SINGLE&quot; ;
  bsdd:status             &quot;Active&quot; ;
  bsdd:versionDateUtc     &quot;2022-12-31T00:00:00&quot;^^xsd:dateTime .

&lt;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegment/InstallationMethodFlagEnum/BELOWCEILING&gt;
  rdf:type    bsdd:PropertyValue ;
  bsdd:code   &quot;BELOWCEILING&quot; ;
  bsdd:value  &quot;BELOWCEILING&quot; .</code></pre>
<h2 data-number="5.3" id="graphql-to-soml-and-back"><span class="header-section-number">5.3</span> GraphQL to SOML and Back</h2>
<p>The major goal of this work is to improve the bSDD RDF representation and GraphQL API.
To achieve this, in addition to refactoring RDF:</p>
<ul>
<li>The original GraphQL schema was fetched with GraphQL introspection: <code>bsdd-graphql-schema-orig.json</code>, 116kb</li>
<li>Then it was converted to a prototypical <a href="https://platform.ontotext.com/semantic-objects/soml/index.html">SOML schema</a> using the script <code>graphql2soml.py</code>: <code>bsdd-graphql-soml-orig.yaml</code>, 22kb.
As you can see from the size, SOML is much easier to understand and edit than a GraphQL schema as JSON DML.
This SOML schema has issues inherited from the original GraphQL schema.
The purpose of the generated SOML schema is to serve as a starting point (instead of starting from scratch)</li>
<li>The schema was refactored by hand, using similar steps as the RDF refactoring above: <code>bsdd-graphql-soml-refact.yaml</code>, 20kb.</li>
<li>That was loaded to <a href="https://platform.ontotext.com/semantic-objects/">Ontotext Platform Semantic Objects</a> to generate a refactored GraphQL schema: <code>bsdd-graphql-schema-refact.json</code>, 867k.
The reason it is so much bigger is that it includes a comprehensive <code>where</code> query language</li>
</ul>
<p>The difference between the two SOML schemas is not so huge:</p>
<div class="sourceCode" id="cb87" data-org-language="sh"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diff</span> <span class="at">-wu1000</span> bsdd-graphql-soml-orig.yaml bsdd-graphql-soml-refact.yaml <span class="op">&gt;</span> bsdd-graphql-soml.patch</span></code></pre></div>
<figure id="fig:bsdd-graphql-soml-diff">
<img src="./img/bsdd-graphql-soml-diff.png" />
<figcaption>
Typical differences between the Original GraphQL schema (red) and the Refactored schema (green)
</figcaption>
</figure>
<p>We explain the differences seen in this figure:</p>
<ul>
<li>Field names in plural are changed to singular because the field cardinality (<code>max</code>) already specifies whether it's single-valued or multi-valued</li>
<li>Field names are changed to reflect the target class.
E.g. <code>Classification.properties</code> is renamed to <code>Classification.classificationProperty</code> because it points to <code>ClassificationProperty</code></li>
<li>Parallel links (e.g. <code>property, properties</code>) are eliminated because
the same relation field (e.g. <code>classificationProperty</code>) can be used to fetch all or a single target entity, by URL (<code>ID</code>) or by search.</li>
<li><code>childClassification</code> in the refactored schema is always available,
unlike <code>childs</code> in the original schema that's available only if the current Classification was fetched with <code>includeChilds: true</code>.
Please note that such "hidden dependencies" violate the GraphQL typing specification.</li>
<li>Bidirectional navigation was added by using so-called "virtual inverses (<code>inverseAlias</code>)
(e.g. <code>parentClassification</code> can be used, even though there is no such relation recorded in the RDF repository).</li>
</ul>
<h2 data-number="5.4" id="sample-queries"><span class="header-section-number">5.4</span> Sample Queries</h2>
<p>A number of SPARQL queries over refactored RDF data are shown in the sections above, because we used them for statistics.
In this section we show some sample GraphQL queries over the refactored endpoint, emphasizing searchability.
They are also saved in folder <code>graphql-refact</code>.</p>
<h3 data-number="5.4.1" id="domains-with-lang-en-and-their-classifications"><span class="header-section-number">5.4.1</span> Domains with lang=EN and their Classifications</h3>
<div class="sourceCode" id="cb88"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> domainEn_Class {</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  domain(where: {languageCode: {EQ: <span class="st">&quot;EN&quot;</span>}}) {</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>    name</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>    classification {</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>      id</span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>      classificationType</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>      name</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This returns thousands of classifications in under 0.2s, e.g.:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;domain&quot;:</span> <span class="ot">[</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/alma/hprops-1.0&quot;</span><span class="fu">,</span></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;h props&quot;</span><span class="fu">,</span></span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;classification&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/alma/hprops-1.0/class/New_class_8_copy_10&quot;</span><span class="fu">,</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;New classification 8&quot;</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span></code></pre></div>
<h3 data-number="5.4.2" id="classificationproperties-in-ifc-class-ifcwall"><span class="header-section-number">5.4.2</span> ClassificationProperties in IFC class IfcWall</h3>
<div class="sourceCode" id="cb90"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> DomainIFC_ClassWall_Props {</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  domain(<span class="dt">ID</span>:<span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3&quot;</span>) {</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    classification(<span class="dt">ID</span>:<span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcWall&quot;</span>) {</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>      name</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>      classificationProperty {</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>        name</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        propertyValueKind</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        propertySet</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This returns some errors about <code>propertySet</code> which is declared as single-valued, but sometimes happens to be multi-valued:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;errors&quot;:</span> <span class="ot">[</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;message&quot;</span><span class="fu">:</span> <span class="st">&quot;Found 2 values for single-valued field &#39;propertySet&#39; from &#39;ClassificationProperty&#39;&quot;</span><span class="fu">,</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;path&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;domain&quot;</span><span class="ot">,</span></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="ot">,</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;classification&quot;</span><span class="ot">,</span></span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span><span class="ot">,</span></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;classificationProperty&quot;</span><span class="ot">,</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>      <span class="dv">24</span><span class="ot">,</span></span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;propertySet&quot;</span></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;locations&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;line&quot;</span><span class="fu">:</span> <span class="dv">9</span><span class="fu">,</span></span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;column&quot;</span><span class="fu">:</span> <span class="dv">9</span></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span><span class="ot">,</span></span></code></pre></div>
<p>It then returns the requested data:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;domain&quot;:</span> <span class="ot">[</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;classification&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">{</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcWall&quot;</span><span class="fu">,</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>          <span class="dt">&quot;classificationProperty&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>            <span class="fu">{</span></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>              <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;GrossFootPrintArea&quot;</span><span class="fu">,</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>              <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>              <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Qto_WallBaseQuantities&quot;</span></span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>            <span class="fu">{</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>              <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;ManufacturingToleranceClass&quot;</span><span class="fu">,</span></span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>              <span class="dt">&quot;propertyValueKind&quot;</span><span class="fu">:</span> <span class="st">&quot;SINGLE&quot;</span><span class="fu">,</span></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a>              <span class="dt">&quot;propertySet&quot;</span><span class="fu">:</span> <span class="st">&quot;Pset_PrecastConcreteElementGeneral&quot;</span></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">}</span><span class="ot">,</span></span></code></pre></div>
<h3 data-number="5.4.3" id="classifications-of-type-composed-property-and-their-constituent-properties"><span class="header-section-number">5.4.3</span> Classifications of Type COMPOSED_PROPERTY and their Constituent Properties</h3>
<p>Composed Properties are groups of thematically related properties.
They are expressed as a specific <code>classificationType</code> COMPOSED_PROPERTY.
Here you can see how we search for this enumerated value:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> Prop_composed {</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  classification(where:{classificationType:{EQ:COMPOSED_PROPERTY}}) {</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>    code name</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    domain {name}</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    classificationProperty {code name}</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Part of the result:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;150822129&quot;</span><span class="fu">,</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Stepped cap beam dimensions&quot;</span><span class="fu">,</span></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;domain&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;MINnD Bridge dictionary&quot;</span></span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;classificationProperty&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;PR2054415455&quot;</span><span class="fu">,</span></span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Elevation of bottom of step&quot;</span></span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;PR445726735&quot;</span><span class="fu">,</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Elevation of top of step&quot;</span></span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;PR1543732693&quot;</span><span class="fu">,</span></span>
<span id="cb94-18"><a href="#cb94-18" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;step depth&quot;</span></span></code></pre></div>
<h3 data-number="5.4.4" id="properties-that-have-connected-properties"><span class="header-section-number">5.4.4</span> Properties that Have Connected Properties</h3>
<div class="sourceCode" id="cb95"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> Prop_connected {</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  property(where: {connectedPropertyCode:{}}) {</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>    id</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>    code</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>    connectedPropertyCode</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Part of the result:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>   <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/bs-agri/fruitvegs-1.1/prop/volume&quot;</span><span class="fu">,</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>   <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;volume&quot;</span><span class="fu">,</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>   <span class="dt">&quot;connectedPropertyCode&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;height&quot;</span><span class="ot">,</span></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;depth&quot;</span><span class="ot">,</span></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;width&quot;</span><span class="ot">,</span></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;diameter&quot;</span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a>   <span class="ot">]</span></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a> <span class="fu">}</span><span class="er">,</span></span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a> <span class="fu">{</span></span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>   <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/uniweimar/uniweimar-0.1/prop/TestObjective&quot;</span><span class="fu">,</span></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>   <span class="dt">&quot;code&quot;</span><span class="fu">:</span> <span class="st">&quot;TestObjective&quot;</span><span class="fu">,</span></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>   <span class="dt">&quot;connectedPropertyCode&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;ComponentID&quot;</span><span class="ot">,</span></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>     <span class="st">&quot;StructureID&quot;</span></span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>   <span class="ot">]</span></span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">}</span><span class="er">,</span></span></code></pre></div>
<h3 data-number="5.4.5" id="pagination"><span class="header-section-number">5.4.5</span> Pagination</h3>
<p>A significant limit of the original implementation is that it doesn't support pagination, i.e. fetching results in sections.
The refactored implementation supports this for any object.
Eg here we fetch 5 classifications from the largest domain, starting at number 100:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> Pagination {</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  domain(<span class="dt">ID</span>:<span class="st">&quot;https://identifier.buildingsmart.org/uri/nbs/uniclass2015-1&quot;</span>) {</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>    classification(offset:<span class="dv">100</span> limit:<span class="dv">5</span>) {</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>      id name</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Result:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;domain&quot;:</span> <span class="ot">[</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;classification&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/nbs/uniclass2015-1/class/Ac_32_10_68&quot;</span><span class="fu">,</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Propagating&quot;</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/nbs/uniclass2015-1/class/En_75_10_10&quot;</span><span class="fu">,</span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Broadcast communications buildings&quot;</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/nbs/uniclass2015-1/class/PM_40_50_12&quot;</span><span class="fu">,</span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Building codes approval&quot;</span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/nbs/uniclass2015-1/class/Pr_40_30_30_32&quot;</span><span class="fu">,</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Food preparation worktops&quot;</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/nbs/uniclass2015-1/class/Pr_60_60_38_42&quot;</span><span class="fu">,</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Instantaneous plate heat exchangers&quot;</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a><span class="ot">]</span></span></code></pre></div>
<h3 data-number="5.4.6" id="classifications-with-relations"><span class="header-section-number">5.4.6</span> Classifications with Relations</h3>
<p>We can easily find Classifications that have relations, then fetch data of their related Classifications:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> ClassificationRel {</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>  classification(where:{relation:{}}) {</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>    id name</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>    relation {</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>      relationType</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>      related {</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>        id name</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>}    </span></code></pre></div>
<p>Please note that for each relation, this returns both the original Classification we started from, and the target Classification.
The reason is that the node <code>ClassificationRelation</code> has two <code>related</code> links:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;classification&quot;:</span> <span class="ot">[</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">{</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/ATALANE/REX-OBJ-1.0/class/262c5f4a-a631-4041-a5ea-569ebad4265b&quot;</span><span class="fu">,</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Revêtement de sol résilient LVT acoustique à poisser&quot;</span><span class="fu">,</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;relation&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;relationType&quot;</span><span class="fu">:</span> <span class="st">&quot;HasReference&quot;</span><span class="fu">,</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;related&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">{</span></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/ATALANE/REX-OBJ-1.0/class/262c5f4a-a631-4041-a5ea-569ebad4265b&quot;</span><span class="fu">,</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Revêtement de sol résilient LVT acoustique à poisser&quot;</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a>          <span class="fu">{</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCovering&quot;</span><span class="fu">,</span></span>
<span id="cb100-15"><a href="#cb100-15" aria-hidden="true" tabindex="-1"></a>            <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCovering&quot;</span></span>
<span id="cb100-16"><a href="#cb100-16" aria-hidden="true" tabindex="-1"></a>          <span class="fu">}</span></span>
<span id="cb100-17"><a href="#cb100-17" aria-hidden="true" tabindex="-1"></a>        <span class="ot">]</span></span>
<span id="cb100-18"><a href="#cb100-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span></code></pre></div>
<h3 data-number="5.4.7" id="relations-of-classifications"><span class="header-section-number">5.4.7</span> Relations of Classifications</h3>
<p>We have implemented bidirectional graph navigation, so we can fetch related Classifications starting from <code>ClassificationRelation</code> instead of <code>Classification</code>:</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> ClassificationRel2 {</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  classificationRelation {</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>    relationType</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    related {</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>      id name</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="er">&quot;classificationRelation&quot;:</span> <span class="ot">[</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">{</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>     <span class="dt">&quot;relationType&quot;</span><span class="fu">:</span> <span class="st">&quot;HasReference&quot;</span><span class="fu">,</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>     <span class="dt">&quot;related&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>       <span class="fu">{</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/ATALANE/REX-OBJ-1.0/class/262c5f4a-a631-4041-a5ea-569ebad4265b&quot;</span><span class="fu">,</span></span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Revêtement de sol résilient LVT acoustique à poisser&quot;</span></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>       <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>       <span class="fu">{</span></span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;id&quot;</span><span class="fu">:</span> <span class="st">&quot;https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCovering&quot;</span><span class="fu">,</span></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>         <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;IfcCovering&quot;</span></span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>       <span class="fu">}</span></span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>     <span class="ot">]</span></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">}</span><span class="ot">,</span></span></code></pre></div>
<h3 data-number="5.4.8" id="length-properties"><span class="header-section-number">5.4.8</span> Length Properties</h3>
<p>Let's find all Properties with <code>dimension</code> vector indicating "length":</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> LengthProps {</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  property(where:{dimension:{EQ:<span class="st">&quot;1 0 0 0 0 0 0&quot;</span>}}) {</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    physicalQuantity</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    unit</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can now compare the variety associated with such properties, e.g.:</p>
<ul>
<li><code>physicalQuantity</code>: "Epaisseur", "Longueur", "Länge", "Fläche je Länge | de-DE", etc</li>
<li><code>unit</code>: "mm", "cm" but also stranger units like "mm²/m"</li>
</ul>
<h2 data-number="5.5" id="graph-visualizations"><span class="header-section-number">5.5</span> Graph Visualizations</h2>
<p>In this section we show a couple of <a href="https://bsdd.ontotext.com/graphdb/graphs-visualizations">GraphDB visualizations</a> that we have implemented
to illustrate some more unusual Classifications and Properties.
Note: if you have a user account, you can enlarge "Maximum links to show" in Settings to see more nodes.</p>
<h3 data-number="5.5.1" id="composed-property-classifications"><span class="header-section-number">5.5.1</span> "COMPOSED_PROPERTY" Classifications</h3>
<p><a href="https://bsdd.ontotext.com/graphdb/graphs-visualizations?config=2dc02fd322a646879505aafde547375a">This visualization</a> shows classifications of type "COMPOSED_PROPERTY" that serve as a container of related properties.</p>
<figure id="fig:viz-ClassCOMPOSED_PROPERTY">
<img src="./img/viz-ClassCOMPOSED_PROPERTY.png" />
<figcaption>
“COMPOSED_PROPERTY” Classifications
</figcaption>
</figure>
<h3 data-number="5.5.2" id="domain-classifications"><span class="header-section-number">5.5.2</span> "DOMAIN" Classifications</h3>
<p><a href="https://bsdd.ontotext.com/graphdb/graphs-visualizations?config=7ecb0edaf0874c0aa81f2f0eb953b8ee">This visualization</a> shows classifications of type "DOMAIN" that serve as a "sub-domain" of Classifications.
Expanding a node shows its ClassificationProperties.</p>
<figure id="fig:viz-ClassDOMAIN">
<img src="./img/viz-ClassDOMAIN.png" />
<figcaption>
“DOMAIN” Classifications
</figcaption>
</figure>
<h3 data-number="5.5.3" id="classification-relations"><span class="header-section-number">5.5.3</span> Classification Relations</h3>
<p><a href="https://bsdd.ontotext.com/graphdb/graphs-visualizations?config=b977ae2529094192b469f3484029fc48">This visualizations</a> shows classifications that have relations (we ignore the relation name).
It shows a number of French classes relating to <code>Space, Slab, Covering</code>.
(Please note that another cluster that has "class" in the middle is due to data quality problems in BSDD.)</p>
<figure id="fig:viz-ClassRel">
<img src="./img/viz-ClassRel.png" />
<figcaption>
Classification Relations
</figcaption>
</figure>
<h3 data-number="5.5.4" id="multivalued-propsets"><span class="header-section-number">5.5.4</span> Multivalued propSets</h3>
<p><code>propSet</code> is expected to be single-valued by the GraphQL schema, but in fact there are some multi-valued occurrences.
<a href="https://bsdd.ontotext.com/graphdb/graphs-visualizations?config=fa3b8af3bc114b9b9046f9ceb11246f7">This visualization</a> looks for such cases (e.g. see this <a href="https://bsdd.ontotext.com/graphdb/graphs-visualizations?saved=56b5379edeeb4a1a80790e9011d8e264">saved visual graph</a>).</p>
<figure id="fig:viz-multivaluedPropSet">
<img src="./img/viz-multivaluedPropSet.png" />
<figcaption>
Multivalued propSet, showing domain (purple), class (yellow), prop (red), set (blue)
</figcaption>
</figure>
<h1 data-number="6" id="acknowledgements"><span class="header-section-number">6</span> Acknowledgements</h1>
<p>This work is partially funded by the European Union's Horizon Europe research and innovation programme under grant agreement no 101056973 (ACCORD).</p>
<p>Author contributions:</p>
<ul>
<li>VA conceived the work, described bSDD shortcomings, implemented GraphQL and RDF refactoring.</li>
<li>MK wrote GraphQL queries, fetched bSDD data, and deployed GraphDB and Ontotext Platform Semantic Objects.</li>
<li>NK performed statistics and comparisons of bSDD data and wrote the final paper.</li>
</ul>
<p>We thank Léon van Berlo and Erik Baars from buildingSmart International for their help with accessing bSDD.</p>
</body>
</html>
