---
title: "SemanticBSDD"
subtitle: "Improving the GraphQL, JSON and RDF Representations of buildingSmart Data Dictionary"
author: "Vladimir Alexiev, Mihail Radkov, Nataliya Keberle"
format:
  revealjs: 
    incremental: false
    footer: "11th Linked Data in Architecture and Construction Workshop, 15--16 June 2023, Matera, Italy"
    slide-number: c/t
    theme: simple
    logo: ../img/ontotext.png
    embed-resources: true
    #parallax-background-image: ../img/background-bridge.png
    #parallax-background-size: "2100px 900px"
    #parallax-background-horizontal: 200
    #parallax-background-vertical: 50
title-slide-attributes:
  data-background-image: ../img/background-bridge.avif
  data-background-size: cover
  data-background-opacity: "0.2"
---
## Objective

- highlight the defects in the original GraphQL implementation of bSDD
- overview the refactored solution proposed by Ontotext
- overview the proposed improvements

## bSDD GraphQL Schema: Voyager 
::: {.panel-tabset}

### Original

[![](../img/bsdd-graphql-voyager-overview.png)](https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-orig.html){preview-link="true"}

### Refactored 

[![](../img/bsdd-graphql-voyager-refact-overview.png)](https://rawgit2.com/Accord-Project/bsdd/main/bsdd-graphql-voyager-refact.html){preview-link="true"}

:::

## bSDD GraphQL Schema: PlantUML 

PlantUML is used with [soml2puml](https://github.com/VladimirAlexiev/soml/tree/master/soml2puml) convertor tool

![](../img/bsdd-graphql-soml-diagram-overview.png)

## Original GraphQL: Findings (1/3) {.smaller}

- reference entities `ReferenceDocument`, `Country`, `Unit`, `Language`
  are disconnected from the rest of the schema
- relation entities have only an incoming link but no outgoing link
- many entities cannot be queried directly from the `Root` 
- no backward arrows to get from a lower-level entity back to its "parent" entity
- a number of parallel arrows. GraphQL schema can use parameters to distinguish between the different uses


## Original GraphQL: Findings (2/3) {.smaller}

At the high level of detail:

- `Property` and `ClassificationProperty` are very similar, but there's no inheritance/relation between them
- `PropertyValue` and `ClassificationPropertyValue` are exactly the same, so can be reduced to one entity

## Original GraphQL: Fragment {.scrollable}

![](../img/bsdd-graphql-voyager-Classification-ClassificationProperty.png)

## Original GraphQL: Findings (3/3) {.smaller}

Even more details:

- mixture of singular/plural in property names

  `property/properties`, 
  `relations`, 
  `synonyms`, 
  `countriesOfUse`, 
  `relatedIfcPropertyNames`, 
  etc.

## Refactored GraphQL: Improvements {.smaller}

- all entities are queryable directly from the `Root`
- link deduplication
- each link is named the same as target entity
- navigation between entities is bidirectional, e.g., `Classification` hierarchy can be navigated both up and down (`parentClassification`, `childClassification`)
- a query can traverse a `Relation` entity to get data about the related entity:
  - `Classification.relation` -> `ClassificationRelation.related` -> `Classification`
  - `Property.relation` -> `PropertyRelation.related` -> `Property`
- a single entity `PropertyValue` is used by both `Property` and `ClassificationProperty`
- property names are in singular

## Refactored GraphQL: Fragment {.scrollable}

![](../img/bsdd-graphql-voyager-refact-Classification-ClassificationProperty.png)

## Graph _i_ QL
::: {.panel-tabset}

### Original

[![](../img/graphiql-orig.png)](https://test.bsdd.buildingsmart.org/graphiql)

### Refactored 

[![](../img/graphiql-refact.png)](https://bsdd.ontotext.com/graphiql/)

:::

# Suggested Improvements

## Presentation (1/3)

- uniform identification for the search
- equal data retrieved from different API
- uniform URI design

## Uniform Identification for the Search(1/3) {.smaller}
![](../img/bSI-search-page.png)

::: {.fragment .highlight-blue}
February 2023: **IfcCableSegment** has id: 
[https://search.bsdd.buildingsmart.org/Classification/Index/58453](https://search.bsdd.buildingsmart.org/Classification/Index/58453)
:::

::: {.fragment .highlight-red} 
May 2023: **IfcCableSegment** has another id: [https://search.bsdd.buildingsmart.org/Classification/Index/70992](https://search.bsdd.buildingsmart.org/Classification/Index/70992)
:::

![](../img/IFC-class-cableSegment-search.png){align="center"}


## Uniform Identification for the Search(2/3) {.smaller}

IfcCableSegment has also unique URI: 

[https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT](https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT)

:::: {.columns}
::: {.column width="20%"}
CableSegment entity as displayed at the bSDD web site
:::
::: {.column width="80%"}
[![](../img/IFC-class-cableSegment-web.png)](https://identifier.buildingsmart.org/uri/buildingsmart/ifc-4.3/class/IfcCableSegmentCABLESEGMENT)
:::
::::

## Uniform Identification for the Search(3/3) {.smaller}

Non-unique identification violates FAIR Findability principle 

F1: (Meta)data are assigned a globally unique and persistent identifier

## Equal Data Retrieved from Different API (1/2) {.smaller}

We have compared three representations returned by the bSDD server:

- JSON from the GraphQL API 
  - ```https://test.bsdd.buildingsmart.org/graphiql/```, 
- JSON from the REST (entity) API
  - ```curl https://identifier.buildingsmart.org/uri/buildingsmart/```
    ```<domain>/class|prop/<name>```
and 
- RDF from the REST (entity) API
  - ```curl -Haccept:text/turtle \\```
    ```      https://identifier.buildingsmart.org/uri/buildingsmart/```
    ```<domain>/class|prop/<name> ```

## Equal Data Retrieved from Different API (2/2) {.smaller}

We selected entities of each class that have the **maximum number of filled fields**, and compared the results returned by each API. 

The differences are here:  
[![](../img/bsdd-data-analysis-sheet-cropped.png)](https://docs.google.com/spreadsheets/d/1z_NRMlExlVuqWhBbSErQ9iiDBY4O_fKMd3avV3-NCmo/edit)

## Uniform URI Design



## Modelling

## Data quality

## Refactoring

## Conclusions and Future Work {.smaller}

Here are further ideas for improvement:

- improvement of [bSDD ontology](https://github.com/buildingSMART/bSDD/blob/master/RDF/preview-bsdd-rdfs-0.4.ttl)
- implement more radical data model refactoring to convert "strings" (countries, reference documents, etc.) into "things"
- link bSDD units of measure to [QUDT ontology](http://qudt.org/2.1/schema/qudt)
- perform deeper data quality analysis using SHACL shapes generation and validation provided by [Ontotext Platform Semantic Objects](https://platform.ontotext.com/semantic-objects/)
- address and resolve more data quality issues, including 
  - seeking correlation between dimension vectors, units of measure and physical quantity, 
  - parsing out enumeration values from `Property/ClassificationProperty` descriptions and creation of corresponding `PropertyValue` lists
- make more graph visualizations
- obtain more interesting statistics using SPARQL

## Acknowledgements {.smaller}

![](../img/accord.png){width=200px} ![](../img/bsdd.png){width=200px} ![](../img/graphdb.png){width=200px} ![](../img/ontotext-platform.png){width=200px}

Funding: [ACCORD project](https://accordproject.eu/), Horizon Europe, grant #101056973

Data: [buildingSMART Data Dictionary](https://www.buildingsmart.org/users/services/buildingsmart-data-dictionary/) 
  (bSI credits: Leon van Berlo, Artur Tomczak, Erik Baars)

Powered by:

- [Ontotext GraphDB](https://graphdb.ontotext.com/)
- [Ontotext Platform Semantic Objects](https://platform.ontotext.com/semantic-objects/)





